var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(c){var d=0;return function(){return d<c.length?{done:!1,value:c[d++]}:{done:!0}}};$jscomp.arrayIterator=function(c){return{next:$jscomp.arrayIteratorImpl(c)}};$jscomp.makeIterator=function(c){var d="undefined"!=typeof Symbol&&Symbol.iterator&&c[Symbol.iterator];return d?d.call(c):$jscomp.arrayIterator(c)};$jscomp.arrayFromIterator=function(c){for(var d,b=[];!(d=c.next()).done;)b.push(d.value);return b};
$jscomp.arrayFromIterable=function(c){return c instanceof Array?c:$jscomp.arrayFromIterator($jscomp.makeIterator(c))};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(c){var d=function(){};d.prototype=c;return new d};$jscomp.underscoreProtoCanBeSet=function(){var c={a:!0},d={};try{return d.__proto__=c,d.a}catch(b){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(c,d){c.__proto__=d;if(c.__proto__!==d)throw new TypeError(c+" is not extensible");return c}:null;
$jscomp.inherits=function(c,d){c.prototype=$jscomp.objectCreate(d.prototype);c.prototype.constructor=c;if($jscomp.setPrototypeOf){var b=$jscomp.setPrototypeOf;b(c,d)}else for(b in d)if("prototype"!=b)if(Object.defineProperties){var a=Object.getOwnPropertyDescriptor(d,b);a&&Object.defineProperty(c,b,a)}else c[b]=d[b];c.superClass_=d.prototype};$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,d,b){c!=Array.prototype&&c!=Object.prototype&&(c[d]=b.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var c=0;return function(d){return $jscomp.SYMBOL_PREFIX+(d||"")+c++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.iterator;c||(c=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[c]&&$jscomp.defineProperty(Array.prototype,c,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.asyncIterator;c||(c=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(c){$jscomp.initSymbolIterator();c={next:c};c[$jscomp.global.Symbol.iterator]=function(){return this};return c};$jscomp.generator={};
$jscomp.generator.ensureIteratorResultIsObject_=function(c){if(!(c instanceof Object))throw new TypeError("Iterator result "+c+" is not an object");};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};
$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(c){this.yieldResult=c};
$jscomp.generator.Context.prototype.throw_=function(c){this.abruptCompletion_={exception:c,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(c){this.abruptCompletion_={return:c};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(c){this.abruptCompletion_={jumpTo:c};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(c,d){this.nextAddress=d;return{value:c}};
$jscomp.generator.Context.prototype.yieldAll=function(c,d){c=$jscomp.makeIterator(c);var b=c.next();$jscomp.generator.ensureIteratorResultIsObject_(b);if(b.done)this.yieldResult=b.value,this.nextAddress=d;else return this.yieldAllIterator_=c,this.yield(b.value,d)};$jscomp.generator.Context.prototype.jumpTo=function(c){this.nextAddress=c};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(c,d){this.catchAddress_=c;void 0!=d&&(this.finallyAddress_=d)};$jscomp.generator.Context.prototype.setFinallyBlock=function(c){this.catchAddress_=0;this.finallyAddress_=c||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(c,d){this.nextAddress=c;this.catchAddress_=d||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(c){this.catchAddress_=c||0;c=this.abruptCompletion_.exception;this.abruptCompletion_=null;return c};$jscomp.generator.Context.prototype.enterFinallyBlock=function(c,d,b){b?this.finallyContexts_[b]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=c||0;this.finallyAddress_=d||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(c,d){d=this.finallyContexts_.splice(d||0)[0];if(d=this.abruptCompletion_=this.abruptCompletion_||d){if(d.isException)return this.jumpToErrorHandler_();void 0!=d.jumpTo&&this.finallyAddress_<d.jumpTo?(this.nextAddress=d.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=c};$jscomp.generator.Context.prototype.forIn=function(c){return new $jscomp.generator.Context.PropertyIterator(c)};
$jscomp.generator.Context.PropertyIterator=function(c){this.object_=c;this.properties_=[];for(var d in c)this.properties_.push(d);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var c=this.properties_.pop();if(c in this.object_)return c}return null};$jscomp.generator.Engine_=function(c){this.context_=new $jscomp.generator.Context;this.program_=c};
$jscomp.generator.Engine_.prototype.next_=function(c){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,c,this.context_.next_);this.context_.next_(c);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(c){this.context_.start_();var d=this.context_.yieldAllIterator_;if(d)return this.yieldAllStep_("return"in d?d["return"]:function(b){return{value:b,done:!0}},c,this.context_.return);this.context_.return(c);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(c){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],c,this.context_.next_);this.context_.throw_(c);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(c,d,b){try{var a=c.call(this.context_.yieldAllIterator_,d);$jscomp.generator.ensureIteratorResultIsObject_(a);if(!a.done)return this.context_.stop_(),a;var e=a.value}catch(f){return this.context_.yieldAllIterator_=null,this.context_.throw_(f),this.nextStep_()}this.context_.yieldAllIterator_=null;b.call(this.context_,e);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var c=this.program_(this.context_);if(c)return this.context_.stop_(),{value:c.value,done:!1}}catch(d){this.context_.yieldResult=void 0,this.context_.throw_(d)}this.context_.stop_();if(this.context_.abruptCompletion_){c=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(c.isException)throw c.exception;return{value:c.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(c){this.next=function(d){return c.next_(d)};this.throw=function(d){return c.throw_(d)};this.return=function(d){return c.return_(d)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(c,d){d=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(d));$jscomp.setPrototypeOf&&$jscomp.setPrototypeOf(d,c.prototype);return d};
$jscomp.polyfill=function(c,d,b,a){if(d){b=$jscomp.global;c=c.split(".");for(a=0;a<c.length-1;a++){var e=c[a];e in b||(b[e]={});b=b[e]}c=c[c.length-1];a=b[c];d=d(a);d!=a&&null!=d&&$jscomp.defineProperty(b,c,{configurable:!0,writable:!0,value:d})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(c){function d(){this.batch_=null}function b(a){return a instanceof e?a:new e(function(b,e){b(a)})}if(c&&!$jscomp.FORCE_POLYFILL_PROMISE)return c;d.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};d.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var a=$jscomp.global.setTimeout;d.prototype.asyncExecuteFunction=function(b){a(b,
0)};d.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var e=a[b];a[b]=null;try{e()}catch(h){this.asyncThrow_(h)}}}this.batch_=null};d.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(n){b.reject(n)}};e.prototype.createResolveAndReject_=
function(){function a(a){return function(c){e||(e=!0,a.call(b,c))}}var b=this,e=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(n){this.reject_(n);return}"function"==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
0;a<this.onSettledCallbacks_.length;++a)f.asyncExecute(this.onSettledCallbacks_[a]);this.onSettledCallbacks_=null}};var f=new d;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var e=this.createResolveAndReject_();try{a.call(b,e.resolve,e.reject)}catch(h){e.reject(h)}};e.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{f(a(b))}catch(t){d(t)}}:
b}var f,d,g=new e(function(a,b){f=a;d=b});this.callWhenSettled_(c(a,f),c(b,d));return g};e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function e(){switch(c.state_){case 1:a(c.result_);break;case 2:b(c.result_);break;default:throw Error("Unexpected state: "+c.state_);}}var c=this;null==this.onSettledCallbacks_?f.asyncExecute(e):this.onSettledCallbacks_.push(e)};e.resolve=b;e.reject=function(a){return new e(function(b,e){e(a)})};e.race=function(a){return new e(function(e,
c){for(var f=$jscomp.makeIterator(a),d=f.next();!d.done;d=f.next())b(d.value).callWhenSettled_(e,c)})};e.all=function(a){var c=$jscomp.makeIterator(a),f=c.next();return f.done?b([]):new e(function(a,e){function d(b){return function(e){g[b]=e;k--;0==k&&a(g)}}var g=[],k=0;do g.push(void 0),k++,b(f.value).callWhenSettled_(d(g.length-1),e),f=c.next();while(!f.done)})};return e},"es6","es3");
$jscomp.checkStringArgs=function(c,d,b){if(null==c)throw new TypeError("The 'this' value for String.prototype."+b+" must not be null or undefined");if(d instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");return c+""};
$jscomp.polyfill("String.prototype.repeat",function(c){return c?c:function(c){var b=$jscomp.checkStringArgs(this,null,"repeat");if(0>c||1342177279<c)throw new RangeError("Invalid count value");c|=0;for(var a="";c;)if(c&1&&(a+=b),c>>>=1)b+=b;return a}},"es6","es3");
$jscomp.polyfill("String.prototype.startsWith",function(c){return c?c:function(c,b){var a=$jscomp.checkStringArgs(this,c,"startsWith");c+="";var e=a.length,f=c.length;b=Math.max(0,Math.min(b|0,a.length));for(var d=0;d<f&&b<e;)if(a[b++]!=c[d++])return!1;return d>=f}},"es6","es3");
$jscomp.iteratorFromArray=function(c,d){$jscomp.initSymbolIterator();c instanceof String&&(c+="");var b=0,a={next:function(){if(b<c.length){var e=b++;return{value:d(e,c[e]),done:!1}}a.next=function(){return{done:!0,value:void 0}};return a.next()}};a[Symbol.iterator]=function(){return a};return a};$jscomp.polyfill("Array.prototype.keys",function(c){return c?c:function(){return $jscomp.iteratorFromArray(this,function(c){return c})}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(c){return c?c:function(c,b,a){var e=this.length||0;0>b&&(b=Math.max(0,e+b));if(null==a||a>e)a=e;a=Number(a);0>a&&(a=Math.max(0,e+a));for(b=Number(b||0);b<a;b++)this[b]=c;return this}},"es6","es3");
var __awaiter=this&&this.__awaiter||function(c,d,b,a){function e(a){return a instanceof b?a:new b(function(b){b(a)})}return new (b||(b=Promise))(function(b,g){function f(b){try{h(a.next(b))}catch(m){g(m)}}function n(b){try{h(a["throw"](b))}catch(m){g(m)}}function h(a){a.done?b(a.value):e(a.value).then(f,n)}h((a=a.apply(c,d||[])).next())})},apps;
(function(c){function d(){return __awaiter(this,void 0,void 0,function e(){return $jscomp.generator.createGenerator(e,function(b){desktop.showToastMessage("Please run from webview2 application!","Web app error","warning");b.jumpToEnd()})})}c.uniprot_assembly="UniProt Xml dataset(*.xml)|*.xml";c.expressionMatrix="Microsoft Excel(*.csv)|*.csv|GCModeller HTS Matrix(*.HTS)|*.HTS";c.ncbi_genbank_assembly="NCBI GenBank assembly(*.gbff)|*.gbff";c.gcmodeller_project="GCModeller Cell Project(*.bioproj)|*.bioproj";
c.fasta_sequence="Fasta sequence file(*.fasta;*.fas;*.fa)|*.fasta;*.fas;*.fa";c.rhea_reactions="Rhea reactions data(*.txt)|*.txt";try{var b=window.chrome.webview.hostObjects.gcmodeller}catch(a){b={scanDatabase:d,openEnrichmentPage:d,sendPost:d}}c.gcmodeller=b;c.run=function(){Router.AddAppHandler(new pages.applets);Router.AddAppHandler(new pages.settings);Router.AddAppHandler(new pages.data_repository);Router.AddAppHandler(new pages.web_task);Router.AddAppHandler(new pages.analysis_project.create_project);
Router.AddAppHandler(new pages.analysis_project.edit_sampleinfo);Router.AddAppHandler(new pages.modeller.create_bioproject);Router.AddAppHandler(new pages.modeller.bioproject);Router.AddAppHandler(new pages.repository.enrichment_database);Router.AddAppHandler(new pages.repository.enzyme_database);Router.AddAppHandler(new pages.repository.uniprot_database);Router.AddAppHandler(new pages.annotations.localblast);Router.AddAppHandler(new pages.viewers.motif_viewer);Router.AddAppHandler(new pages.viewers.view_protein_blast);
Router.AddAppHandler(new pages.viewers.metabolic_viewer);Router.AddAppHandler(new pages.viewers.vcell_viewer);Router.AddAppHandler(new pages.enrichment_analysis);Router.AddAppHandler(new pages.cmeans_patterns);Router.AddAppHandler(new pages.zscore_analysis);Router.AddAppHandler(new pages.dataEmbedding);Router.AddAppHandler(new pages.runPLAS);Router.RunApp()}})(apps||(apps={}));$ts.mode=Modes.debug;$ts(apps.run);var desktop;
(function(c){(function(c){c.RSharpErrorMessage=function(b){var a="R# Error:",e=1;if("string"==typeof b.Message)a=a+"&nbsp;"+b.Message.replace(/[<]/ig,"&lt;");else{a+="<br/><br/>";for(var c=$jscomp.makeIterator(b.Message),d=c.next();!d.done;d=c.next())d=d.value,a+="&nbsp;&nbsp;"+e++ +"."+d.replace(/[<]/ig,"&lt;")+"<br/>"}a=a+"<br/>"+("&nbsp;&nbsp;&nbsp;"+b.Source.replace(/[<]/ig,"&lt;")+"<br/>");a+="&nbsp;&nbsp;&nbsp;"+"~".repeat(b.Source.length)+"<br/>";a+="<br/>";b=$jscomp.makeIterator(b.StackTrace);
for(e=b.next();!e.done;e=b.next())c=e.value,e=c.Method.Namespace+"."+c.Method.Module+"."+c.Method.Method,e=e+" at "+c.File+" line "+c.Line,a+=e.replace(/[<]/ig,"&lt;")+"<br />";return a};c.isRSharpError=function(b){var a=TypeScript.Reflection.$typeof(b);return $ts(["Message","Source","TypeFullName","StackTrace"]).All(function(b){return-1<a.property.indexOf(b)})}})(c.RSharp||(c.RSharp={}))})(desktop||(desktop={}));
(function(c){c.promiseAsyncCallback=function(d,b){return __awaiter(this,void 0,void 0,function e(){return $jscomp.generator.createGenerator(e,function(e){c.parseMessage(d).then(function(e){c.parseResultFlag(d,e).then(function(c){b(c,e)})});e.jumpToEnd()})})};c.loading=function(c){c=void 0===c?"Loading...":c;$ts("#spinner-message").display(c);$ts("#busy-indicator").show()};c.closeSpinner=function(){$ts("#busy-indicator").hide()};c.showTaskAlert=function(){$ts("#task_submit_alert").show()}})(desktop||
(desktop={}));
(function(c){c.now=function(){return(new Date).toLocaleTimeString()};c.parseResultFlag=function(c,b){return __awaiter(this,void 0,void 0,function e(){var f,d;return $jscomp.generator.createGenerator(e,function(e){if(1==e.nextAddress)return e.yield(c.result,2);d=(f=e.yieldResult)&&0==b.code;return e.return(d)})})};c.parseMessage=function(c){return __awaiter(this,void 0,void 0,function a(){var e,f;return $jscomp.generator.createGenerator(a,function(a){if(1==a.nextAddress)return a.yield(c.data,2);e=
a.yieldResult;if($ts.csv.isTsvFile(e))f={code:0,info:e};else if(e.startsWith("data:"))f={code:0,info:e};else try{f=JSON.parse(e)}catch(k){f={code:500,info:e}}return a.return(f)})})};c.processHtmlMsg=function(d){"string"==typeof d?(d=d.replace(/[<]/ig,"&lt;"),d=Strings.lineTokens(d).join("<br />")):d=c.RSharp.isRSharpError(d)?c.RSharp.RSharpErrorMessage(d):"Unhandle error!";return d}})(desktop||(desktop={}));
(function(c){function d(a,e,f,d,k){e=void 0===e?"Task Error":e;f=void 0===f?"":f;d=void 0===d?"danger":d;return $ts("<div>",{class:["toast","show","fade","toast-"+d],role:"alert","aria-live":"assertive","aria-atomic":"true","data-mdb-color":d,"data-mdb-autohide":(void 0===k?!0:k).toString(),style:"width: 500px;"}).display('        \n            <div class="toast-header toast-'+d+'">\n                <i class="'+b[d]+'"></i>\n                <strong class="me-auto">'+e+"</strong>\n                <small>"+
(f&&"null"!=f.toLowerCase()?f:"")+'</small>\n                <button type="button" class="btn-close" data-mdb-dismiss="toast" aria-label="Close">\n                </button>\n            </div>\n            <div class="toast-body">'+c.processHtmlMsg(a)+"</div>\n        ")}c.showToastMessage=function(a,b,f,g){b=void 0===b?"Task Error":b;f=void 0===f?"info":f;g=void 0===g?!0:g;$ts("#busy-indicator").hide();$ts("#toast-message").appendElement(d(a,b,c.now(),f,g))};var b={success:"fas fa-check fa-lg me-2",
danger:"fas fa-exclamation-circle fa-lg me-2",warning:"fas fa-exclamation-triangle fa-lg me-2",info:"fas fa-info-circle fa-lg me-2"}})(desktop||(desktop={}));
(function(c){(function(d){d.openfileDialog=function(b,a){a=void 0===a?"any file(*.*)|*.*":a;c.loading();apps.gcmodeller.getFileOpen(a).then(function(a){return __awaiter(this,void 0,void 0,function g(){var e,d;return $jscomp.generator.createGenerator(g,function(g){if(1==g.nextAddress)return g.yield(a,2);e=g.yieldResult;d=$ts(b);d.value=e;c.closeSpinner();g.jumpToEnd()})})})}})(c.winforms||(c.winforms={}))})(desktop||(desktop={}));
(function(c){c=c.languages||(c.languages={});c[c.System=0]="System";c[c["zh-CN"]=1]="zh-CN";c[c["en-US"]=2]="en-US";c[c["fr-FR"]=3]="fr-FR"})(desktop||(desktop={}));var js_plot;
(function(c){var d=function(b){b=void 0===b?"Rplot_js":b;this.option={};var a=window.echarts;$ts("#"+b).clear().removeAttribute("_echarts_instance_");this.myChart=a.init(document.getElementById(b),null,{renderer:"canvas",useDirtyRect:!1});this.option&&this.myChart.setOption(this.option)};d.prototype.hookChartResizeEvt=function(){window.addEventListener("resize",this.myChart.resize)};d.prototype.show=function(){this.option&&this.myChart.setOption(this.option)};c.echarts_ts=d})(js_plot||(js_plot={}));
(function(c){var d=function(b){return c.echarts_ts.call(this,void 0===b?"Rplot_js":b)||this};$jscomp.inherits(d,c.echarts_ts);d.prototype.plot=function(b){this.option={xAxis:{type:"category",data:$from(b).Select(function(a){return a.name}).ToArray(),axisLabel:{rotate:45}},yAxis:{type:"value"},tooltip:{trigger:"item"},series:[{data:$from(b).Select(function(a){return a.value}).ToArray(),type:"bar"}]};this.show()};c.barplot=d})(js_plot||(js_plot={}));
(function(c){var d=function(b){return c.echarts_ts.call(this,void 0===b?"container":b)||this};$jscomp.inherits(d,c.echarts_ts);d.prototype.plot=function(b,a){console.log("view of the graph data:");console.log(a);this.option={title:{text:b,subtext:"Default layout",top:"bottom",left:"right"},tooltip:{},legend:[{data:a.categories.map(function(a){return a.name})}],series:[{name:b,type:"graph",layout:"force",data:a.nodes,links:a.links,categories:a.categories,roam:!0,label:{position:"right"},force:{repulsion:100},
lineStyle:{width:3}}]};this.show()};c.graph_plot=d})(js_plot||(js_plot={}));
(function(c){var d=function(b,a,e){e=void 0===e?"Rplot_js":e;var f=c.echarts_ts.call(this,e)||this;f.title=b;f.subtitle=a;f.div=e;return f};$jscomp.inherits(d,c.echarts_ts);d.prototype.plot=function(b,a,e){e=void 0===e?null:e;b=[{data:a,type:"line",areaStyle:{},smooth:!0,markPoint:{symbol:"none",symbolSize:1},name:b}];if(e)for(e=$jscomp.makeIterator(e),a=e.next();!a.done;a=e.next())a=a.value,b.push({data:a.data,type:"line",areaStyle:{},smooth:!0,markPoint:{symbol:"none",symbolSize:1},name:a.name});
this.option={title:{text:this.title,subtext:this.subtitle,left:"center"},tooltip:{trigger:"item"},xAxis:{type:"value"},yAxis:{type:"value"},series:b,legend:{orient:"vertical",show:!0}};this.show()};c.lineplot=d})(js_plot||(js_plot={}));
(function(c){var d=function(b,a,e){e=c.echarts_ts.call(this,void 0===e?"Rplot_js":e)||this;e.title=b;e.subtitle=a;return e};$jscomp.inherits(d,c.echarts_ts);d.prototype.plot=function(b,a){this.option={title:{text:this.title,subtext:this.subtitle,left:"center"},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left",show:!1},series:[{name:b,type:"pie",radius:"50%",data:a,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};this.show()};c.piePlot=d})(js_plot||
(js_plot={}));(function(c){var d=function(b){return c.echarts_ts.call(this,void 0===b?"Rplot_js":b)||this};$jscomp.inherits(d,c.echarts_ts);d.prototype.plot=function(b,a){this.option={grid3D:{},xAxis3D:{},yAxis3D:{},zAxis3D:{},dataset:{dimensions:["","dim1","dim2","dim3"],source:b},series:[{type:"scatter3D",symbolSize:void 0===a?30:a,encode:{x:"dim1",y:"dim2",z:"dim3",tooltip:[0,1,2,3]}}]};this.show();this.hookChartResizeEvt()};c.scatter3d=d})(js_plot||(js_plot={}));var pages;
(function(c){var d=function(b){return Bootstrap.apply(this,arguments)||this};$jscomp.inherits(d,Bootstrap);d.prototype.generateSsid=function(b){b=void 0===b?{}:b;b=JSON.stringify(b);b=desktop.now()+"-"+b+"-"+this.appName;return md5(b)};c.analysis_session=d})(pages||(pages={}));
(function(c){function d(a,b){var e=[];e.push(new c.suggestion_list.term(b,a.title));e.push(new c.suggestion_list.term(b,a.appLink));e.push(new c.suggestion_list.term(b,a.desc));return e}c.toSearchTerm=d;var b=function(){var a=Bootstrap.apply(this,arguments)||this;a.appList=[{appLink:"apps.gcmodeller.openZscore",title:"Z-score analysis",desc:"Z-score analysis",icon:b.defaultIcon},{appLink:"apps.gcmodeller.openDataEmbedding",title:"Data Embedding",desc:"PCA/UMAP/t-SNE data embedding",icon:b.defaultIcon},
{appLink:"apps.gcmodeller.openCMeans",title:"Fuzzy CMeans",desc:"Fuzzy cmeans clustering",icon:b.defaultIcon},{appLink:"apps.gcmodeller.openPLAS",title:"PLAS",desc:"bio-chemical system simulator",icon:b.defaultIcon},{appLink:"apps.gcmodeller.openMotifViewer",title:"Motif logo",desc:"View motif matrix in web logo rendering",icon:b.defaultIcon}];a.terms=[];return a};$jscomp.inherits(b,Bootstrap);b.prototype.init=function(){c.background.run();b.showAppList(this.appList);for(var a=0;a<this.appList.length;a++)for(var e=
$jscomp.makeIterator(d(this.appList[a],a)),f=e.next();!f.done;f=e.next())this.terms.push(f.value);this.suggestions=new c.suggestion_list.suggestion(this.terms);this.hookSearchBar()};b.prototype.hookSearchBar=function(){var a=$ts("#applets"),e=this,c=$ts("#form1");c.onchange=function(){if(c.value&&""!=c.value){var f=c.value;a.clear();f=$jscomp.makeIterator(e.suggestions.populateSuggestion(f,6,!1));for(var d=f.next();!d.done;d=f.next())d=b.buildElement(e.appList[d.value.id]),a.appendChild(d)}else b.showAppList(e.appList)}};
b.showAppList=function(a){var b=$ts("#applets").clear();a=$jscomp.makeIterator(a);for(var d=a.next();!d.done;d=a.next())b.appendChild(c.applets.buildElement(d.value))};b.buildElement=function(a){return $ts("<div>",{class:["col-xl-4","col-lg-6","mb-4"]}).display('     \n<a href="#" onclick="'+a.appLink+'();" class="card ripple bg-image hover-zoom">\n    <div class="card-body">\n        <div class="d-flex align-items-center">\n            <img src="'+a.icon+'" alt="" class="img-fluid rounded icon-image" />\n            <div class="ms-3">\n                <p class="fw-bold mb-1">'+
a.title+'</p>\n                <p class="text-muted mb-0">'+a.desc+"</p>\n            </div>\n        </div>\n    </div>\n</a>\n")};$jscomp.global.Object.defineProperties(b.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return"applets"}}});b.defaultIcon="/assets/images/background.jpg";c.applets=b})(pages||(pages={}));
(function(c){var d=function(b){return Bootstrap.apply(this,arguments)||this};$jscomp.inherits(d,Bootstrap);d.prototype.init=function(){};$jscomp.global.Object.defineProperties(d.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return"data_repository"}}});c.data_repository=d})(pages||(pages={}));var omicsAnalysis;
(function(c){c.parseSampleInfo=function(c,b,a){a=void 0===a?null:a;$ts.get(sampleInfoUrl+c,function(e){0!=e.code?isNullOrUndefined(a)?desktop.showToastMessage(e.info,"Parse SampleInfo","danger"):a(e.info):(e=$ts.csv.toObjects(e.info).ToArray(!1),TypeScript.logging.table(e),b(e))})};c.saveSampleInfo=function(c,b,a){var e={csv:$ts.csv.toText(c)};b="@api:save?file="+b+"&category=sampleInfo";TypeScript.logging.table(c);TypeScript.logging.log(b,TypeScript.ConsoleColors.DarkRed);$ts.post(b,e,function(b){desktop.closeSpinner();
0!=b.code?desktop.showToastMessage(b.info,"Save SampleInfo","danger"):(desktop.showToastMessage(b.info,"Save SampleInfo","success"),a())})}})(omicsAnalysis||(omicsAnalysis={}));
(function(c){var d=function(b){return Bootstrap.apply(this,arguments)||this};$jscomp.inherits(d,Bootstrap);d.prototype.GetSettings=function(){return apps.gcmodeller.GetSettings()};d.prototype.SaveSettings=function(){var b=apps.gcmodeller,a={BlastBin:$ts("#ncbi_blast_folder").CType().value,BlastDb:"",RepositoryRoot:$ts("#repository_folder").CType().value,RememberWindowStatus:$ts("#RememberWindowStatus").CType().checked,Language:$ts("#language").CType().selectedIndex,CloseAfterProjectLoad:$ts("#CloseAfterProjectLoad").CType().checked,
ShowOnStartUp:$ts("#ShowOnStartUp").CType().checked};a=JSON.stringify(a);b.SaveSettings(a)};d.prototype.init=function(){desktop.loading("Load configurations...");this.rawConfigs=this.GetSettings();this.loadSettings()};d.prototype.loadSettings=function(){return __awaiter(this,void 0,void 0,function a(){var e=this,c,d,k,n,h,l,m,p,q,r;return $jscomp.generator.createGenerator(a,function(a){switch(a.nextAddress){case 1:return a.yield(e.rawConfigs,2);case 2:return c=a.yieldResult,a.yield(c.Dev2,3);case 3:return d=
a.yieldResult,a.yield(d.IDE,4);case 4:return k=a.yieldResult,a.yield(d.StartPage,5);case 5:return n=a.yieldResult,h=$ts("#RememberWindowStatus").CType(),a.yield(d.RememberWindowStatus,6);case 6:return h.checked=a.yieldResult,l=$ts("#CloseAfterProjectLoad").CType(),a.yield(n.CloseAfterProjectLoad,7);case 7:return l.checked=a.yieldResult,m=$ts("#ShowOnStartUp").CType(),a.yield(n.ShowOnStartUp,8);case 8:return m.checked=a.yieldResult,p=$ts("#language").CType(),a.yield(k.Language,9);case 9:return p.selectedIndex=
a.yieldResult,q=$ts("#ncbi_blast_folder").CType(),a.yield(c.BlastBin,10);case 10:return q.value=a.yieldResult,r=$ts("#repository_folder").CType(),a.yield(c.RepositoryRoot,11);case 11:r.value=a.yieldResult,setTimeout(desktop.closeSpinner,500),a.jumpToEnd()}})})};d.prototype.RememberWindowStatus_onchange=function(){this.SaveSettings()};d.prototype.language_onchange=function(){this.SaveSettings()};d.prototype.CloseAfterProjectLoad_onclick=function(){this.SaveSettings()};d.prototype.ShowOnStartUp_onclick=
function(){this.SaveSettings()};d.prototype.open_ncbi_blast_folder_onclick=function(){var b=$ts("#ncbi_blast_folder"),a=this;desktop.loading("Load configurations...");apps.gcmodeller.getFolderOpen().then(function(e){return __awaiter(this,void 0,void 0,function g(){var c;return $jscomp.generator.createGenerator(g,function(d){if(1==d.nextAddress)return c=b,d.yield(e,2);c.value=d.yieldResult;desktop.closeSpinner();Strings.Empty(b.value,!0)||a.SaveSettings();d.jumpToEnd()})})})};d.prototype.open_repository_folder_onclick=
function(){var b=$ts("#repository_folder"),a=this;desktop.loading("Load configurations...");apps.gcmodeller.getFolderOpen().then(function(e){return __awaiter(this,void 0,void 0,function g(){var c;return $jscomp.generator.createGenerator(g,function(d){if(1==d.nextAddress)return c=b,d.yield(e,2);c.value=d.yieldResult;desktop.closeSpinner();Strings.Empty(b.value,!0)||a.SaveSettings();d.jumpToEnd()})})})};$jscomp.global.Object.defineProperties(d.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return"settings"}}});
c.settings=d})(pages||(pages={}));
(function(c){var d={success:"badge-success",error:"badge-danger",pending:"badge-warning",cancel:"badge-default",running:"badge-success"},b=function(a){return Bootstrap.apply(this,arguments)||this};$jscomp.inherits(b,Bootstrap);b.prototype.init=function(){var a=this;apps.gcmodeller.getTaskList().then(function(b){return __awaiter(this,void 0,void 0,function g(){var e;return $jscomp.generator.createGenerator(g,function(c){if(1==c.nextAddress)return c.yield(b,2);e=c.yieldResult;a.showTaskDatalist(e,function(){desktop.showToastMessage("Load "+
e.length+" web task!","Task Manager","info");setInterval(function(){return a.checkList()},6E3)});c.jumpToEnd()})})})};b.prototype.checkList=function(){var a=this;apps.gcmodeller.checkTaskList().then(function(b){return __awaiter(this,void 0,void 0,function g(){var e,c,d,l,m,p;return $jscomp.generator.createGenerator(g,function(g){if(1==g.nextAddress)return g.yield(b,2);e=g.yieldResult;if(c=0<e.length)for(apps.gcmodeller.getTaskList().then(function(b){return __awaiter(this,void 0,void 0,function u(){var e;
return $jscomp.generator.createGenerator(u,function(c){if(1==c.nextAddress)return c.yield(b,2);e=c.yieldResult;a.showTaskDatalist(e,function(){console.log("task list has been updated!")});c.jumpToEnd()})})}),d=$jscomp.makeIterator(e),l=d.next();!l.done;l=d.next())m=l.value,p=JSON.parse(m),"success"==p.status?desktop.showToastMessage("Run ["+p.title+"] success!","Task Manager","success"):"error"==p.status&&desktop.showToastMessage("Run ["+p.title+"] failured!","Task Manager","danger");g.jumpToEnd()})})})};
b.prototype.showTaskDatalist=function(a,b){b=void 0===b?null:b;a=$from(a).Select(function(a){return JSON.parse(a)}).ToArray();this.loadTaskList(a).then(function(a){isNullOrUndefined(b)||b()})};b.prototype.loadTaskList=function(a){return __awaiter(this,void 0,void 0,function f(){var c,d,n,h,l,m,p;return $jscomp.generator.createGenerator(f,function(f){switch(f.nextAddress){case 1:c=$ts("#task_manager").clear(),n=null,h={},l=$jscomp.makeIterator(a),m=l.next();case 2:if(m.done){f.jumpTo(4);break}h.$jscomp$loop$prop$task$30=
m.value;p=h;return f.yield(b.getHostObject(h.$jscomp$loop$prop$task$30),5);case 5:p.$jscomp$loop$prop$task$30=f.yieldResult;n=h.$jscomp$loop$prop$task$30.session_id.replace(/\./ig,"-");d=b.buildTaskHtml(h.$jscomp$loop$prop$task$30,n);c.appendElement(d);localStorage.setItem(h.$jscomp$loop$prop$task$30.session_id,JSON.stringify(h.$jscomp$loop$prop$task$30.arguments));$ts("#"+n).onclick=function(a){return function(){apps.gcmodeller.openPage(a.$jscomp$loop$prop$task$30.session_id,JSON.stringify(a.$jscomp$loop$prop$task$30))}}(h);
h={$jscomp$loop$prop$task$30:h.$jscomp$loop$prop$task$30};m=l.next();f.jumpTo(2);break;case 4:return f.return(0)}})})};b.getHostObject=function(a){return __awaiter(this,void 0,void 0,function f(){var b,c,d,h,l,m,p,q,r,t;return $jscomp.generator.createGenerator(f,function(f){switch(f.nextAddress){case 1:return c=b={},f.yield(a.appName,2);case 2:return c.appName=f.yieldResult,d=b,f.yield(a.arguments,3);case 3:return d.arguments=f.yieldResult,h=b,f.yield(a.error,4);case 4:return h.error=f.yieldResult,
l=b,f.yield(a.logtext,5);case 5:return l.logtext=f.yieldResult,m=b,f.yield(a.session_id,6);case 6:return m.session_id=f.yieldResult,p=b,f.yield(a.status,7);case 7:return p.status=f.yieldResult,q=b,f.yield(a.time,8);case 8:return q.time=f.yieldResult,r=b,f.yield(a.title,9);case 9:return r.title=f.yieldResult,t=b,f.yield(a.url,10);case 10:return t.url=f.yieldResult,console.log(b),f.return(b)}})})};b.buildTaskHtml=function(a,b){return $ts("<tr>").display('          \n            <td>\n                <div class="d-flex align-items-center">\n                    <img src="/assets/images/dna-image.jpg" alt=""\n                        style="width: 45px; height: 45px" class="rounded-circle" />\n                    <div class="ms-3">\n                        <p class="fw-bold mb-1">\n                            <a id="'+
b+'" href="#" onclick="javascript:void(0);">'+a.appName+'</a>\n                        </p>\n                        <p class="text-muted mb-0">'+a.session_id+'</p>\n                    </div>\n                </div>\n            </td>\n            <td>\n                <p class="fw-normal mb-1">'+a.title+'</p>\n                <p class="text-muted mb-0">'+a.time+'</p>\n            </td>\n            <td>\n                <span class="badge '+d[a.status]+' rounded-pill d-inline">'+a.status+"</span>\n            </td>\n            <td>"+
a.logtext+'</td>\n            <td>\n                <button type="button" class="btn btn-link btn-sm btn-rounded">\n                    Cancel\n                </button>\n                <button type="button" class="btn btn-link btn-sm btn-rounded">\n                    Delete\n                </button>\n            </td>       \n            ')};$jscomp.global.Object.defineProperties(b.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return"web_task"}}});c.web_task=b})(pages||(pages=
{}));
(function(c){var d=function(b){return c.analysis_session.apply(this,arguments)||this};$jscomp.inherits(d,c.analysis_session);d.prototype.init=function(){};d.prototype.button_open_click=function(){desktop.winforms.openfileDialog("#matrix-file",apps.expressionMatrix)};d.prototype.run_onclick=function(){var b=this;desktop.loading();var a=$ts.value("#rows"),e=$ts.value("#cols"),d=$ts.select.getOption("#algorithm"),g=$ts("#z-score").CType().checked,k=$ts.value("#matrix-file"),n={layout:[a,e],algorithm:d,z_score:g,
file:k,ssid:""};n.ssid=c.analysis_session.prototype.generateSsid.call(this,n);apps.gcmodeller.sendPost($ts.url("@web_invoke_clustering"),JSON.stringify(n)).then(function(a){return __awaiter(this,void 0,void 0,function m(){return $jscomp.generator.createGenerator(m,function(c){desktop.promiseAsyncCallback(a,function(a,c){a?(b.session_id=n.ssid,b.refresh_Rplot_onclick(),a=$ts.csv(c.info,!0).Objects().Take(10),$ts("#patterns-table").clear(),$ts.appendTable(a,"#patterns-table",null,{class:["table","table-sm"]})):
desktop.showToastMessage(c.info,"Run CMeans","danger")});c.jumpToEnd()})})})};d.prototype.refresh_Rplot_onclick=function(){var b=$ts.select.getOption("#colorSet");b={ssid:this.session_id,colorSet:b};desktop.loading();apps.gcmodeller.sendPost($ts.url("@web_invoke_Rplot"),JSON.stringify(b)).then(function(a){return __awaiter(this,void 0,void 0,function f(){return $jscomp.generator.createGenerator(f,function(b){desktop.promiseAsyncCallback(a,function(a,b){a?(a=b.info+"?refresh="+md5(desktop.now()),$ts("#Rplot-box").CType().href=
a,$ts("#Rplot_js").CType().src=a,$ts.goto("#example-3-collapsible"),$ts("#busy-indicator").hide(),desktop.showToastMessage("Expression data patterns plot success!","Plot Patterns","success")):desktop.showToastMessage(b.info,"Plot Patterns","danger")});b.jumpToEnd()})})})};$jscomp.global.Object.defineProperties(d.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return"cmeans_pattern"}}});c.cmeans_patterns=d})(pages||(pages={}));
(function(c){var d=function(b){return c.analysis_session.apply(this,arguments)||this};$jscomp.inherits(d,c.analysis_session);d.prototype.init=function(){};d.prototype.button_open_click=function(){var b=$ts("#matrix-file").CType(),a=$ts("#busy-indicator");a.show();apps.gcmodeller.getFileOpen("Excel Matrix(*.csv)|*.csv").then(function(c){return __awaiter(this,void 0,void 0,function g(){var e;return $jscomp.generator.createGenerator(g,function(d){if(1==d.nextAddress)return e=b,d.yield(c,2);e.value=d.yieldResult;
a.hide();d.jumpToEnd()})})})};d.prototype.run_click=function(){desktop.loading();var b=$ts.value("#matrix-file"),a=$ts.value("#dimensions"),e=$ts.select.getOption("#algorithm"),f=c.analysis_session.prototype.generateSsid.call(this,{file:b,dims:a,algo:e}),g=$ts("#z-score").CType().checked;a=JSON.stringify({file:b,ssid:f,dims:a,algorithm:e,z_score:g});var k=this;Strings.Empty(b)?desktop.showToastMessage("The matrix data input file can not be nothing!","Data Embedding Analysis","danger"):apps.gcmodeller.sendPost($ts.url("@web_invoke_embedding"),
a).then(function(a){return __awaiter(this,void 0,void 0,function l(){return $jscomp.generator.createGenerator(l,function(b){desktop.promiseAsyncCallback(a,function(a,b){a?(a=$ts.csv(b.info,!0).Objects().Take(10),k.session_id=f,$ts("#embedding-table").clear(),$ts.appendTable(a,"#embedding-table",null,{class:["table","table-sm"]}),d.plot3DScatter(f),desktop.showToastMessage("Run Data Embedding Analysis Success!",e+" Task Success","success")):desktop.showToastMessage(b.info,e+" Task Error","danger")});
b.jumpToEnd()})})})};d.plot3DScatter=function(b){b=JSON.stringify({ssid:b,k:$ts.value("#kmeans")});apps.gcmodeller.sendPost($ts.url("@web_invoke_Rplot"),b).then(function(a){desktop.promiseAsyncCallback(a,function(a,b){a?(a=b.info+"?refresh="+md5(desktop.now()),$ts("#Rplot-box").CType().href=a,$ts("#Rplot_js").CType().src=a,$ts.goto("#example-3-collapsible"),$ts("#busy-indicator").hide()):desktop.showToastMessage(b.info,"Rplot Error","danger")})})};d.prototype.refresh_Rplot_click=function(){desktop.loading();
Strings.Empty(this.session_id)?desktop.showToastMessage("Data session id can not be nothing!","Rplot Error","danger"):d.plot3DScatter(this.session_id)};d.prototype.save_project_click=function(){desktop.showToastMessage("You should run this analysis from a data analysis project","Report Error","danger")};d.prototype.download_zip_click=function(){var b=$ts.url("@web_invoke_zip"),a=JSON.stringify({ssid:this.session_id});desktop.loading();Strings.Empty(this.session_id)?desktop.showToastMessage("Data session id can not be nothing!",
"Report Error","danger"):apps.gcmodeller.sendPost(b,a).then(function(a){return __awaiter(this,void 0,void 0,function g(){return $jscomp.generator.createGenerator(g,function(b){desktop.promiseAsyncCallback(a,function(a,b){a?window.open(b.info,"newW","\n                                height=500, width=800, top=100, left=100, toolbar=no, \n                                menubar=no,\n                                scrollbars=no,resizable=no, location=no, \n                                status=no"):
desktop.showToastMessage(b.info,"Report Error","danger");$ts("#download-group").show();$ts("#busy-indicator").hide()});b.jumpToEnd()})})})};$jscomp.global.Object.defineProperties(d.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return"dataEmbedding"}}});c.dataEmbedding=d})(pages||(pages={}));
(function(c){var d=function(b){return c.analysis_session.apply(this,arguments)||this};$jscomp.inherits(d,c.analysis_session);d.prototype.init=function(){var b=this;$ts.location.hasQueryArguments&&(this.database=$ts.location("id"));console.log($ts.location);$ts("#busy-indicator").hide();$ts("#background").onchange=function(){b.background_onchange($ts.select.getOption("#background"))}};d.prototype.background_onchange=function(b){var a=d.note_mapping[b],c;for(c in d.note_mapping)$ts("#"+d.note_mapping[c]).hide();
console.log("show about '"+b+" -> "+a+"'!");$ts("#"+a).show()};d.prototype.run_onclick=function(){if(Strings.Empty(this.database))desktop.showToastMessage("Please select a database at first!","Enrichment Analysis","danger");else{desktop.loading();var b=$ts.select.getOption("#background"),a=$ts.value("#input_idlist");Strings.Empty(b)?desktop.showToastMessage("Please select a background for enrichment analysis at first!","Enrichment Analysis","danger"):Strings.Empty(a)?desktop.showToastMessage("No gene/protein id list to run enrichment analysis!",
"Enrichment Analysis","danger"):this.runInternal(b,a)}};d.term_url=function(b){switch(b){case "keyword":return function(a){return'<a target="__blank" href="https://www.uniprot.org/keywords/'+a[""]+'">'+a.name+"</a>"};case "GO":return function(a){return'<a target="__blank" href="http://amigo.geneontology.org/amigo/term/'+a[""]+'">'+a.name+"</a>"};case "Pfam":return function(a){return'<a target="__blank" href="https://www.ebi.ac.uk/interpro/entry/pfam/'+a[""]+'/">'+a.name+"</a>"};case "InterPro":return function(a){return'<a target="__blank" href="https://www.ebi.ac.uk/interpro/entry/InterPro/'+
a[""]+'/">'+a.name+"</a>"};case "EC":return function(a){return'<a target="__blank" href="https://www.genome.jp/dbget-bin/www_bfind_sub?mode=bfind&max_hit=1000&dbkey=enzyme&keywords='+a[""]+'">'+a.name+"</a>"};default:return function(a){return a.name}}};d.prototype.runInternal=function(b,a){var e=c.analysis_session.prototype.generateSsid.call(this,{type:b,symbols:a}),f=this;a=JSON.stringify({id:this.database,background:b,symbols:Strings.lineTokens(a),ssid:e});var g=d.term_url(b);apps.gcmodeller.sendPost($ts.url("@web_invoke_enrichment"),
a).then(function(a){desktop.promiseAsyncCallback(a,function(a,b){var c=a?"Run Enrichment Success":"Analysis Error",d=b.info;console.log(d);a?(a=$ts.csv(d,!0).Objects().Where(function(a){return.05>a.pvalue}).Select(function(a){a.name=g(a);return a}),$ts("#enrichment-result-table").clear(),$ts.appendTable(a,"#enrichment-result-table",null,{class:["table","table-sm"]}),f.session_id=e,f.plot_onclick(),desktop.showToastMessage("Success!",c,"success")):desktop.showToastMessage(b.info,c,"danger")})})};d.prototype.plot_onclick=
function(){desktop.loading();var b=JSON.stringify({session_id:this.session_id,type:"bar",background:$ts.select.getOption("#background"),top:5});apps.gcmodeller.sendPost($ts.url("@web_invoke_Rplot?base64=true"),b).then(function(a){return __awaiter(this,void 0,void 0,function f(){return $jscomp.generator.createGenerator(f,function(b){desktop.parseMessage(a).then(function(b){desktop.parseResultFlag(a,b).then(function(a){var c=a?"Run Enrichment Success":"Analysis Error",d=b.info;console.log(d);a?($ts("#Rplot").CType().src=
d,$ts("#Rplot-box").CType().href=d,$ts("#busy-indicator").hide()):desktop.showToastMessage(b.info,c,"danger")})});b.jumpToEnd()})})})};$jscomp.global.Object.defineProperties(d.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return"enrichment_analysis"}}});d.note_mapping={GO:"go_note",keyword:"uniprot_note",Pfam:"pfam_note",InterPro:"interpro_note",EC:"ec_note",eggNOG:"eggnog_note"};c.enrichment_analysis=d})(pages||(pages={}));
(function(c){var d=function(b){return c.analysis_session.apply(this,arguments)||this};$jscomp.inherits(d,c.analysis_session);d.prototype.init=function(){this.add_equation_click()};d.prototype.loadDemo_click=function(){$ts.value("#time_final","30");$ts.value("#resolution","100");$ts("#equations").clear();$ts("#constant-list").clear();for(var b=$jscomp.makeIterator([["x1=beta1*(lamda1*(1+alpha1*(x4^n1)/(1+x4^n1))-x1)",-10],["x2=x1-x2",-10],["x3=beta3*(lamda3*(1+alpha2*((x4/a)^n2)/(1+(x4/a)^n2))*(1/(1+x2^n3))-x3)",
0],["x4=beta4*(x3-x4)",10]]),a=b.next();!a.done;a=b.next()){a=a.value;var c=this.add_equation_click();c.eq.value=a[0].toString();c.y0.value=a[1].toString()}b=$jscomp.makeIterator([["beta1","30"],["beta3","30"],["beta4","1"],["lamda1","2"],["lamda3","2"],["alpha1","20"],["alpha2","20"],["alpha3","1"],["a","1"],["n1","4"],["n2","5"],["n3","1"]]);for(a=b.next();!a.done;a=b.next())a=a.value,c=this.add_constant_click(),c.name.value=a[0].toString(),c.val.value=a[1].toString();this.equationIndexing($ts(".eq-index"));
this.equationIndexing($ts(".const-index"));desktop.showToastMessage("Load 'Atkinson.txt' demo example success!","PLAS Script","info")};d.prototype.add_equation_click=function(){var b=$ts("#equations"),a=$ts("<div>",{class:["input-group","mb-3","equation"]}).display('\n                <span class="input-group-text eq-index">1. </span>\n                <input type="text" class="form-control" placeholder="y=f(x) at here"\n                    aria-label="ode">\n                <span class="input-group-text">, y<sub>0</sub>=</span>\n                <input type="text" class="form-control"\n                    placeholder="Initial value of variable y" aria-label="y0">\n                <button class="btn btn-danger del-eq" type="button"> Remove\n                </button>\n            '),
c=this,d=a.getElementsByTagName("input"),g=d.item(0);d=d.item(1);b.appendElement(a);$ts(".del-eq").onClick(function(a){a.removeAttribute("onclick");b.removeChild(a.parentElement);c.equationIndexing($ts(".eq-index"))});c.equationIndexing($ts(".eq-index"));return{eq:g,y0:d}};d.prototype.equationIndexing=function(b){b.ForEach(function(a,b){a.innerText=b+1+". "})};d.prototype.add_constant_click=function(){var b=$ts("#constant-list"),a=$ts("<div>",{class:["input-group","mb-3","const"]}).display('\n                <span class="input-group-text const-index">1. </span>\n                <input type="text" class="form-control" placeholder="put constant symbol name at here"\n                    aria-label="constant">\n                <span class="input-group-text">, constant value=</span>\n                <input type="text" class="form-control"\n                    placeholder="Constant value of current symbol" aria-label="const_val">\n                <button class="btn btn-danger del-const" type="button"> Remove\n                </button>\n            '),
c=this,d=a.getElementsByTagName("input"),g=d.item(0);d=d.item(1);b.appendElement(a);$ts(".del-const").onClick(function(a){a.removeAttribute("onclick");b.removeChild(a.parentElement);c.equationIndexing($ts(".const-index"))});c.equationIndexing($ts(".const-index"));return{name:g,val:d}};d.loadContents=function(b){b=$ts("."+b);var a=[];b.ForEach(function(b){var c=b.getElementsByTagName("input");b=c.item(0);c=c.item(1);b={target:b.value,value:c.value};Strings.Empty(b.target)||a.push(b)});a.length!=b.Count&&
desktop.showToastMessage("Some data is leaves empty, you can removes these empty data slots.","Check PLAS Parameters","warning");return a};d.prototype.run_click=function(){var b=this;desktop.loading();var a=d.loadContents("equation"),e=d.loadContents("const"),f=$ts.value("#time_final"),g=$ts.value("#resolution");if(0==a.length)desktop.showToastMessage("No ODEs system equations!","Check PLAS Parameters","danger");else{var k=c.analysis_session.prototype.generateSsid.call(this,{sys:a,const:e,t:f,resolution:g});
a=JSON.stringify({odes:JSON.stringify(a),constants:JSON.stringify(e),final_time:f,resolution:g,session_id:k});apps.gcmodeller.sendPost($ts.url("@web_invoke_run_plas"),a).then(function(a){return __awaiter(this,void 0,void 0,function l(){return $jscomp.generator.createGenerator(l,function(c){desktop.promiseAsyncCallback(a,function(a,c){a?(a=$ts.csv(c.info,!0).Objects(),$ts("#plas-table").clear(),$ts.appendTable(a,"#plas-table",null,{class:["table","table-sm"]}),b.session_id=k,b.createPlot(),desktop.showToastMessage("Run system simulation job done!",
"Run PLAS","success")):desktop.showToastMessage(c.info,"Run PLAS","danger");desktop.closeSpinner()});c.jumpToEnd()})})})}};d.prototype.createPlot=function(){var b=JSON.stringify({ssid:this.session_id});apps.gcmodeller.sendPost($ts.url("@web_invoke_Rplot"),b).then(function(a){return __awaiter(this,void 0,void 0,function f(){return $jscomp.generator.createGenerator(f,function(b){desktop.promiseAsyncCallback(a,function(a,b){a?(a=b.info+"?refresh="+md5(desktop.now()),$ts("#Rplot-box").CType().href=a,
$ts("#Rplot_js").CType().src=a,$ts.goto("#example-3"),desktop.showToastMessage("Simulator data rendering job done!","Run PLAS","info")):desktop.showToastMessage(b.info,"Run PLAS","danger")});b.jumpToEnd()})})})};$jscomp.global.Object.defineProperties(d.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return"plas"}}});c.runPLAS=d})(pages||(pages={}));
(function(c){var d=function(b){return c.analysis_session.apply(this,arguments)||this};$jscomp.inherits(d,c.analysis_session);d.prototype.init=function(){};d.prototype.button_open_onclick=function(){desktop.loading("Open matrix file...");apps.gcmodeller.getFileOpen(apps.expressionMatrix).then(function(b){return __awaiter(this,void 0,void 0,function e(){var c,d;return $jscomp.generator.createGenerator(e,function(e){if(1==e.nextAddress)return e.yield(b,2);c=e.yieldResult;d=$ts("#matrix-file");d.value=
c;desktop.closeSpinner();e.jumpToEnd()})})})};d.prototype.run_onclick=function(){var b=this;desktop.loading("Do z-score plot...");var a={file:$ts.value("#matrix-file"),ssid:""};a.ssid=c.analysis_session.prototype.generateSsid.call(this,a);apps.gcmodeller.sendPost($ts.url("@web_invoke_zscore"),JSON.stringify(a)).then(function(c){return __awaiter(this,void 0,void 0,function g(){return $jscomp.generator.createGenerator(g,function(e){desktop.promiseAsyncCallback(c,function(c,e){c?(b.session_id=a.ssid,
b.refresh_Rplot_onclick(),c=$ts.csv(e.info,!0).Objects().Take(10),$ts("#zscore-table").clear(),$ts.appendTable(c,"#zscore-table",null,{class:["table","table-sm"]})):desktop.showToastMessage(e.info,"Run Z-score","danger")});e.jumpToEnd()})})})};d.prototype.refresh_Rplot_onclick=function(){var b=$ts.select.getOption("#colorSet");b={ssid:this.session_id,colorSet:b};desktop.loading("Do z-score plot...");apps.gcmodeller.sendPost($ts.url("@web_invoke_Rplot"),JSON.stringify(b)).then(function(a){return __awaiter(this,
void 0,void 0,function f(){return $jscomp.generator.createGenerator(f,function(b){desktop.promiseAsyncCallback(a,function(a,b){a?(a=b.info+"?refresh="+md5(desktop.now()),$ts("#Rplot-box").CType().href=a,$ts("#Rplot_js").CType().src=a,$ts.goto("#example-3-collapsible"),desktop.closeSpinner(),desktop.showToastMessage("Expression data patterns plot success!","Plot Z-score","success")):desktop.showToastMessage(b.info,"Plot Z-score","danger")});b.jumpToEnd()})})})};$jscomp.global.Object.defineProperties(d.prototype,
{appName:{configurable:!0,enumerable:!0,get:function(){return"z_score"}}});c.zscore_analysis=d})(pages||(pages={}));
(function(c){(function(c){var b=function(){var a=Bootstrap.apply(this,arguments)||this;a.project=null;return a};$jscomp.inherits(b,Bootstrap);b.prototype.init=function(){var a=$ts.location("params"),b=$ts.location("session");Strings.Empty(a,!0)?Strings.Empty(b,!0)||(this.loadParameters(b),$ts("#protocols").interactive(!1),$ts("#button_open_query").interactive(!1),$ts("#query-file").interactive(!1),$ts("#button_open_reference").interactive(!1),$ts("#reference-file").interactive(!1),$ts("#run").interactive(!1)):
this.loadParameters(a)};b.prototype.loadParameters=function(a){a=JSON.parse(localStorage.getItem(a));$ts.value("#query-file",a.query);$ts.value("#reference-file",a.reference);$ts.value("#protocols",a.protocol);this.project=a.project};b.prototype.button_open_query_onclick=function(){desktop.winforms.openfileDialog("#query-file",apps.fasta_sequence)};b.prototype.button_open_reference_onclick=function(){desktop.winforms.openfileDialog("#reference-file",apps.fasta_sequence)};b.prototype.run_onclick=function(){var a=
{query:$ts.value("#query-file"),reference:$ts.value("#reference-file"),evalue:.001,n_threads:2,project:this.project,protocol:$ts.select.getOption("#protocols")};apps.gcmodeller.createTask("Run blast search",$ts.url("@web_invoke_localblast"),JSON.stringify(a)).then(function(a){return __awaiter(this,void 0,void 0,function g(){var b;return $jscomp.generator.createGenerator(g,function(c){if(1==c.nextAddress)return c.yield(a.data,2);b=c.yieldResult;desktop.showTaskAlert();desktop.showToastMessage("Pending a new task: "+
b,"Localblast Search","info");c.jumpToEnd()})})})};b.prototype.save_project_onclick=function(){$ts.post("@web_invoke_save_project",{proj:this.project,blast_dir:$ts.value("#query-file"),protocol:$ts.select.getOption("#protocols")},function(a){})};$jscomp.global.Object.defineProperties(b.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return"localblast"}}});c.localblast=b})(c.annotations||(c.annotations={}))})(pages||(pages={}));
(function(c){(function(c){var b=function(a){return Bootstrap.apply(this,arguments)||this};$jscomp.inherits(b,Bootstrap);b.prototype.init=function(){this.expr1_onclick()};b.prototype.expr1_onclick=function(){$ts("#expr1").addClass("stepper-active");$ts("#sample2").removeClass("stepper-active");$ts("#create3").removeClass("stepper-active");$ts("#panel1").show();$ts("#panel2").hide();$ts("#panel3").hide()};b.prototype.sample2_onclick=function(){$ts("#expr1").removeClass("stepper-active");$ts("#sample2").addClass("stepper-active");
$ts("#create3").removeClass("stepper-active");$ts("#panel1").hide();$ts("#panel2").show();$ts("#panel3").hide()};b.prototype.create3_onclick=function(){$ts("#expr1").removeClass("stepper-active");$ts("#sample2").removeClass("stepper-active");$ts("#create3").addClass("stepper-active");$ts("#panel1").hide();$ts("#panel2").hide();$ts("#panel3").show()};b.prototype.button_open_matrix_click=function(){var a=$ts("#matrix-file").CType(),b=this;apps.gcmodeller.getFileOpen("Excel Table(*.csv)|*.csv|GCModeller HTS Matrix(*.HTS)|*.HTS").then(function(c){return __awaiter(this,
void 0,void 0,function k(){var e;return $jscomp.generator.createGenerator(k,function(d){if(1==d.nextAddress)return e=a,d.yield(c,2);e.value=d.yieldResult;b.check_matrix(a.value);d.jumpToEnd()})})})};b.prototype.check_matrix=function(a){};b.prototype.button_open_sampleinfo_click=function(){var a=$ts("#sample-file").CType();apps.gcmodeller.getFileOpen("Excel Table(*.csv)|*.csv").then(function(b){return __awaiter(this,void 0,void 0,function g(){var c;return $jscomp.generator.createGenerator(g,function(e){if(1==
e.nextAddress)return c=a,e.yield(b,2);c.value=e.yieldResult;e.jumpToEnd()})})})};$jscomp.global.Object.defineProperties(b.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return"create_project"}}});c.create_project=b})(c.analysis_project||(c.analysis_project={}))})(pages||(pages={}));
(function(c){(function(c){var b=function(a){return Bootstrap.apply(this,arguments)||this};$jscomp.inherits(b,Bootstrap);b.prototype.init=function(){app.initSampleEditor();var a=this;this.reset();$ts("#save").onclick=function(){a.save(null)}};b.prototype.reset=function(){var a=this,b=this;omicsAnalysis.parseSampleInfo(this.analysisFile,function(b){return a.beginEditSampleInfo1(b)},function(){layer.confirm("\u8001\u5e08\u597d\uff0c\u60a8\u76ee\u524d\u8fd8\u6ca1\u6709\u4e0a\u4f20\u6837\u672c\u5206\u7ec4\u4fe1\u606f\u6587\u4ef6\uff0c\u662f\u5426\u9700\u8981\u8fdb\u884c\u81ea\u52a8\u89e3\u6790\uff1f",
{btn:["\u786e\u5b9a","\u53d6\u6d88"]},function(){desktop.closeSpinner();b.beginEditSampleInfo0()},function(){$goto("/analysis/file?analysis_file="+$ts("@analysis_file"))})})};b.prototype.beginEditSampleInfo0=function(){var a=this;$ts.get("@api:xcms_id",function(b){0==b.code?a.beginEditSampleInfo($from(b.info).Skip(1).ToArray(!1)):desktop.showToastMessage(b.info,"Sample Editor","danger")})};b.prototype.beginEditSampleInfo1=function(a){var b=this,c=this;c.sampleEditor=new sampleinfo_editor.ui.sampleInfoUI("#edit_sampleinfo",
a,function(a){return b.xload_sampleInfo(a)},function(){return c.editor.fieldHeaders})};b.prototype.beginEditSampleInfo=function(a){var b=this,c=this;TypeScript.logging.log("all sample names from the raw matrix data:");TypeScript.logging.log(JSON.stringify(a));c.sampleEditor=new sampleinfo_editor.ui.sampleInfoUI("#edit_sampleinfo",a,function(a){return b.xload_sampleInfo(a)},function(){return c.editor.fieldHeaders})};b.prototype.save=function(a){desktop.loading("Save your sample information, wait for a while...");
for(var b=0,c=this.editor.TableRows(),d=$jscomp.makeIterator(this.editor.TableData(!1)),k=d.next();!k.done;k=d.next())k=k.value,this.sampleInfo[k.ID].injectionOrder=k.injectionOrder,this.sampleInfo[k.ID].batch=k.batch,this.sampleInfo[k.ID].sample_info=k.sample_info,this.sampleInfo[k.ID].sample_info1=k.sample_info1,this.sampleInfo[k.ID].sample_info2=k.sample_info2,this.sampleInfo[k.ID].sample_name=k.sample_name,c[b++].dropFlag?this.sampleInfo[k.ID].delete="1":this.sampleInfo[k.ID].delete="0";b=[];
for(var n in this.sampleInfo)b.push(this.sampleInfo[n]);omicsAnalysis.saveSampleInfo(b,this.analysisFile,a)};b.prototype.xload_sampleInfo=function(a){for(var c=!1,d=$jscomp.makeIterator(a),g=d.next();!g.done;g=d.next())g=g.value,Strings.Empty(g.delete,!0)?g.delete="0":"undefined"==g.delete&&(g.delete="0"),Strings.Empty(""+g.injectionOrder,!0)&&(g.injectionOrder=0),Strings.Empty(""+g.batch,!0)&&(g.batch=0),"sample_ID"in g?(g.ID=g.sample_ID,c=!0,delete g.sample_ID):Strings.Empty(g.ID,!0)&&""in g&&(g.ID=
g[""],c=!0,delete g[""]);c&&desktop.showToastMessage("We found some format error in your sampleinfo table file, please click on the [Save] button for fix this probem!","SampleInfo Editor","warning");this.sampleInfo={};this.editor=sampleinfo_editor.table_editor.fromData(a,"#edit_sampleinfo","ID sample_name sample_info sample_info1 sample_info2 injectionOrder batch".split(" "),{deleteRow:b.deleteSampleRow,className:"table",table_id:"sampleinfo",allowsAddNew:!1,names:{remove:"\u5220\u9664\u6837\u672c",
edit:"\u7f16\u8f91\u6837\u672c",OK:"\u786e\u8ba4",cancel:"\u53d6\u6d88",actions:"\u64cd\u4f5c"},tdConfig:[{title:"\u6837\u672c\u7f16\u53f7",lockEditor:!0},{title:"\u6837\u672c\u540d\u79f0",lockEditor:!1},{title:"\u7ec4\u522b\u540d\u79f0",lockEditor:!1},{title:"\u4e9a\u578b\u5206\u7c7bA",lockEditor:!1},{title:"\u4e9a\u578b\u5206\u7c7bB",lockEditor:!1},{title:"\u8fdb\u6837\u987a\u5e8f",lockEditor:!1},{title:"\u8fdb\u6837\u6279\u6b21",lockEditor:!1}]});c=this.editor.TableRows();d=0;a=$jscomp.makeIterator(a);
for(g=a.next();!g.done;g=a.next()){var k=g.value;this.sampleInfo[k.ID]=k;g=c[d++];"0"!=k.delete&&b.deleteSampleRow(g.tr,g)}return this.editor.table};b.deleteSampleRow=function(a,b){a.cells.item(0);b.dropFlag?(a.style.backgroundColor="white",b.getElementById("remove").innerHTML="\u5220\u9664\u6837\u672c"):(a.style.backgroundColor="gray",b.getElementById("remove").innerHTML="\u6062\u590d\u6837\u672c");b.dropFlag=!b.dropFlag};$jscomp.global.Object.defineProperties(b.prototype,{appName:{configurable:!0,
enumerable:!0,get:function(){return"edit_sampleinfo"}}});c.edit_sampleinfo=b})(c.analysis_project||(c.analysis_project={}))})(pages||(pages={}));
(function(c){(function(c){var b=function(a,b,c,d,k,n,h){a=void 0===a?document.createElement("canvas"):a;b=void 0===b?a.getContext("2d"):b;c=void 0===c?{x:null,y:null,max:2E4}:c;d=void 0===d?[0,0]:d;k=void 0===k?[]:k;this.uCanvas=a;this.uContext=b;this.f=c;this.size=d;this.dots=k;this.setting=void 0===n?null:n;this.frameRender=void 0===h?null:h};b.getTag=function(a){return document.getElementsByTagName(a)[0]};b.getById=function(a){return document.getElementById(a)};b.prototype.canvasResize=function(){this.uCanvas.width=
window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;this.uCanvas.height=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;this.size=[this.uCanvas.width,this.uCanvas.height]};b.prototype.update=function(){var a=this,c=[a.f].concat(a.dots),d,g,k;a.uContext.clearRect(0,0,a.size[0],a.size[1]);var n=$jscomp.makeIterator(a.dots);for(d=n.next();!d.done;d=n.next()){var h=d.value;h.x+=h.xa;h.y+=h.ya;h.xa*=h.x>a.size[0]||0>h.x?-1:1;h.ya*=h.y>
a.size[1]||0>h.y?-1:1;a.uContext.fillRect(h.x-.5,h.y-.5,1,1);for(g=0;g<c.length;g++)if(d=c[g],h!==d&&null!==d.x&&null!==d.y){var l=h.x-d.x;var m=h.y-d.y;var p=l*l+m*m;p<d.max&&(d===a.f&&p>=d.max/2&&(h.x-=.03*l,h.y-=.03*m),k=(d.max-p)/d.max,a.uContext.beginPath(),a.uContext.lineWidth=k/2,a.uContext.strokeStyle="rgba("+a.setting.color+", "+(k+.2)+")",a.uContext.moveTo(h.x,h.y),a.uContext.lineTo(d.x,d.y),a.uContext.stroke())}c.splice(c.indexOf(h),1)}b.defaultCallback(function(){return a.update()})};
b.defaultCallback=function(a){window.setTimeout(a,1E3/45);return 0};b.prototype.registerDevice=function(){var a=this;a.frameRender=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||b.defaultCallback;window.onresize=a.canvasResize;window.onmousemove=function(b){b=b||window.event;a.f.x=b.clientX;a.f.y=b.clientY};window.onmouseout=function(){a.f.x=null;a.f.y=null}};c.network=b;c.run=function(a,
c){a=void 0===a?null:a;c=void 0===c?{canvasId:"canvas-network-display",zIndex:-1,opacity:1,color:"0,104,183",n:100}:c;var d=new b;d.setting=c;d.uCanvas.id="canvas_"+c.canvasId;d.uCanvas.style.cssText="position:fixed; top:0; left:0; z-index: "+c.zIndex+"; opacity: "+c.opacity;a?b.getById(a).appendChild(d.uCanvas):b.getTag("body").appendChild(d.uCanvas);d.canvasResize();d.registerDevice();for(a=0;c.n>a;a++)d.dots.push({x:Math.random()*d.size[0],y:Math.random()*d.size[1],xa:2*Math.random()-1,ya:2*Math.random()-
1,max:1E4});setTimeout(function(){return d.update()},100)}})(c.background||(c.background={}))})(pages||(pages={}));
(function(c){(function(c){var b=function(a){return Bootstrap.apply(this,arguments)||this};$jscomp.inherits(b,Bootstrap);b.prototype.init=function(){this.path=decodeURIComponent($ts.location("proj"));this.loadSummary(this.path);$ts("#path").display(this.path)};b.showPiePlot=function(a){var b=a.total,c=a.number_enzymes;b=0>b-c?0:b-c;(new js_plot.piePlot("Protein Annotations","Metabolic Annotation","summary_pie")).plot("protein numbers",[{name:"enzymes",value:c},{name:"no annotation",value:b}]);var d=
a.enzyme_class;c=$from(Object.keys(d)).Select(function(a){return{name:a,value:d[a]}}).ToArray();(new js_plot.piePlot("Metabolic Annotation","Enzyme Class Counts","summary_enzyme_pie")).plot("protein numbers",c);var k=a.subcellular_locations;a=$from(Object.keys(k)).Select(function(a){return{name:a,value:k[a]}}).ToArray();(new js_plot.piePlot("Subcellular Locations Annotation","Metabolic Locations","summary_location_pie")).plot("protein numbers",a)};b.prototype.loadSummary=function(a){a="@web_invoke_inspect_model?proj="+
encodeURIComponent(a);$ts.get(a,function(a){0!=a.code?desktop.showToastMessage("Load project file error!","Project Reader","danger"):(a=a.info,console.log(a),b.showPiePlot(a))})};b.prototype.enzyme_anno_onclick=function(){var a=this;desktop.loading("Extract protein set, wait for a while...");apps.gcmodeller.getNextUniqueId().then(function(b){return __awaiter(this,void 0,void 0,function g(){return $jscomp.generator.createGenerator(g,function(c){if(1==c.nextAddress)return c.yield(b,2);b=c.yieldResult;
$ts.post("@web_invoke_extract_proteins",{proj:a.path,ssid:b},function(c){console.log(c);0==c.code?a.create_localBlastTask(c,b,"ontology_annotation"):desktop.showToastMessage(c.info,"Extract Data Error","danger");desktop.closeSpinner()});c.jumpToEnd()})})})};b.prototype.subcellular_anno_onclick=function(){var a=this;desktop.loading("Extract protein set, wait for a while...");apps.gcmodeller.getNextUniqueId().then(function(b){return __awaiter(this,void 0,void 0,function g(){return $jscomp.generator.createGenerator(g,
function(c){if(1==c.nextAddress)return c.yield(b,2);b=c.yieldResult;$ts.post("@web_invoke_extract_proteins",{proj:a.path,ssid:b},function(c){console.log(c);0==c.code?a.create_localBlastTask(c,b,"subcellular_location"):desktop.showToastMessage(c.info,"Extract Data Error","danger");desktop.closeSpinner()});c.jumpToEnd()})})})};b.prototype.create_localBlastTask=function(a,b,c){var d=a.info.dataset,e=this.path;a={ontology_annotation:function(a){return a.info.blast.ec_numbers},subcellular_location:function(a){return a.info.blast.subcellular_location}}[c](a);
c={query:d,reference:a,n_threads:2,evalue:.001,project:e,protocol:c};console.log("view of the annotation parameters:");console.log(c);localStorage.setItem(b,JSON.stringify(c));apps.gcmodeller.openLocalBlast(b)};$jscomp.global.Object.defineProperties(b.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return"bioproject"}}});c.bioproject=b})(c.modeller||(c.modeller={}))})(pages||(pages={}));
(function(c){(function(c){var b=function(a){return Bootstrap.apply(this,arguments)||this};$jscomp.inherits(b,Bootstrap);b.prototype.init=function(){};b.prototype.button_open_gbff_onclick=function(){var a=$ts("#gbff-file").CType(),b=this;apps.gcmodeller.getFileOpen(apps.ncbi_genbank_assembly).then(function(c){return __awaiter(this,void 0,void 0,function k(){var d;return $jscomp.generator.createGenerator(k,function(e){if(1==e.nextAddress)return d=a,e.yield(c,2);d.value=e.yieldResult;Strings.Empty(a.value,
!0)||b.viewModelSummary(a.value);e.jumpToEnd()})})})};b.prototype.viewModelSummary=function(a){$ts.get("@web_invoke_inspector?gbff="+encodeURIComponent(a),function(a){0!=a.code&&desktop.showToastMessage(a.info,"Load GenBank Assembly Error","danger")})};b.prototype.create_project_onclick=function(){var a=$ts("#gbff-file").CType();Strings.Empty(a.value,!0)?desktop.showToastMessage("No data file is selected!","Create Project","danger"):apps.gcmodeller.getFileSave(apps.gcmodeller_project).then(function(b){return __awaiter(this,
void 0,void 0,function g(){return $jscomp.generator.createGenerator(g,function(c){if(1==c.nextAddress)return c.yield(b,2);b=c.yieldResult;Strings.Empty(b,!0)||(desktop.loading("Create project from genbank assembly..."),$ts.post("@web_invoke_imports",{gbff:a.value,savefile:b},function(a){0!=a.code&&desktop.showToastMessage(a.info,"Create Project","danger")}));c.jumpToEnd()})})})};$jscomp.global.Object.defineProperties(b.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return"create_bioproject"}}});
c.create_bioproject=b})(c.modeller||(c.modeller={}))})(pages||(pages={}));
(function(c){(function(c){var b=function(a){return Bootstrap.apply(this,arguments)||this};$jscomp.inherits(b,Bootstrap);b.prototype.init=function(){this.scanDatabaseList()};b.prototype.scanDatabaseList=function(){var a=this;desktop.loading();apps.gcmodeller.scanDatabase().then(function(b){return __awaiter(this,void 0,void 0,function g(){var c;return $jscomp.generator.createGenerator(g,function(d){if(1==d.nextAddress)return d.yield(b,2);c=d.yieldResult;a.showDatabaseList(c);d.jumpToEnd()})})})};b.prototype.showDatabaseList=
function(a){a=JSON.parse(a||"[]");var c=Object.keys(a).length,d=$ts("#repository"),g={},k;for(k in a){g.$jscomp$loop$prop$key$34=k;g.$jscomp$loop$prop$metadata$35=a[g.$jscomp$loop$prop$key$34];var n=b.buildDbCard(g.$jscomp$loop$prop$key$34,g.$jscomp$loop$prop$metadata$35);d.appendElement(n);console.log(g.$jscomp$loop$prop$key$34);$ts("#"+g.$jscomp$loop$prop$key$34).onclick=function(a){return function(){apps.gcmodeller.openEnrichmentPage(a.$jscomp$loop$prop$key$34,a.$jscomp$loop$prop$metadata$35.name,
a.$jscomp$loop$prop$metadata$35.note)}}(g);$ts("#"+g.$jscomp$loop$prop$key$34+"-meta").onclick=function(a){return function(){desktop.loading();b.showMetadata(a.$jscomp$loop$prop$key$34,a.$jscomp$loop$prop$metadata$35)}}(g);g={$jscomp$loop$prop$key$34:g.$jscomp$loop$prop$key$34,$jscomp$loop$prop$metadata$35:g.$jscomp$loop$prop$metadata$35}}desktop.closeSpinner();desktop.showToastMessage("Found "+c+" database.","Enrichment Database Repository","info")};b.showMetadata=function(a,c){var d="",e=JSON.stringify({guid:a});
d+='<span class="badge badge-primary">Database Name</span>: '+c.name+"("+a+")<br />";d+='<span class="badge badge-primary">Note</span>: <p class="note note-light">'+c.note+"</p><br />";apps.gcmodeller.sendPost($ts.url("@web_invoke_inspector"),e).then(function(c){return __awaiter(this,void 0,void 0,function h(){return $jscomp.generator.createGenerator(h,function(e){desktop.promiseAsyncCallback(c,function(c,e){b.displayDatabaseContentSummary(a,d,c,e)});e.jumpToEnd()})})})};b.displayDatabaseContentSummary=
function(a,c,d,g){var e=d?"Load Database Success":"Load Database Error",f=g.info,h=null;console.log(f);if(d){var l=$from(Object.keys(f.summary)).Select(function(a){return{name:a,info:f.summary[a]}}).Where(function(a){return 0<a.info.unique_size}).Where(function(a){return 1<a.info.unique_size/a.info.clusters});d=l.Select(function(a){return b.summaryLine(a.name,a.info)}).JoinBy("");desktop.showToastMessage("Success!",e,"success");h=function(){for(var c={},d=$jscomp.makeIterator(l.ToArray()),e=d.next();!e.done;c=
{$jscomp$loop$prop$name$37:c.$jscomp$loop$prop$name$37,$jscomp$loop$prop$model$38:c.$jscomp$loop$prop$model$38},e=d.next())c.$jscomp$loop$prop$model$38=e.value,c.$jscomp$loop$prop$name$37=c.$jscomp$loop$prop$model$38.name,e="#model-"+c.$jscomp$loop$prop$name$37,console.log(e),$ts(e).onclick=function(c){return function(){desktop.loading();console.log("view background model: "+c.$jscomp$loop$prop$name$37+"...");b.viewModel(a,c.$jscomp$loop$prop$name$37,c.$jscomp$loop$prop$model$38.info)}}(c)};c+='<span class="badge badge-primary">Protein Counts</span>: '+
f.counts+"<br />";c+='<span class="badge badge-primary">Models</span>: '+l.Count+"<br />";c+='<span class="badge badge-primary">Backgrounds</span>: <br /><br />\n                        <ul class="list-group list-group-light">\n                            '+d+"\n                        </ul>\n                    "}else desktop.showToastMessage(g.info,e,"danger");$ts("#summary-info").display(c);isNullOrUndefined(h)||h()};b.viewModel=function(a,b,c){$ts.post("@web_invoke_loadModel",{guid:a,xref:b},
function(a){if(0==a.code){var b=new bootstrap.Modal($ts("#view-background"),{keyboard:!1}),c=a.info.clusters;a=Object.keys(c);a=$from(a).Select(function(a){return'\n                                <li>                                   \n                                    <a \n                                        href="#" \n                                        onclick="pages.enrichment_database.showProteins(\''+c[a].join(",")+'\')">\n                                        <i class="far fa-file-code"></i>&nbsp;&nbsp;'+
a.replace(/[<]/ig,"&lt;")+"\n                                        ["+c[a].length+" proteins]\n                                    </a>                                     \n                                </li>                              \n                            "});$ts("#contentArea").clear();$ts("#contentArea").display(a.JoinBy(""));$ts("#busy-indicator").hide();$ts("#modal-close1").onclick=function(){return b.hide()};$ts("#modal-close2").onclick=function(){return b.hide()};b.show()}else desktop.showToastMessage(a.info,
"Load Model Error","danger")})};b.showProteins=function(a){$ts("#protein_ids").CType().value=a.replace(/,/ig,"\n")};b.summaryLine=function(a,b){return'<li class="list-group-item d-flex justify-content-between align-items-center">\n                        <div class="d-flex align-items-center">\n                            <span class="badge rounded-pill badge-success">                \n                                <i class="fab fa-laravel"></i>&nbsp;'+a+"              \n                            </span>\n                            "+
b.clusters+" / "+b.unique_size+'\n                        </div>\n                        <a id="model-'+a+'" class="btn btn-link btn-rounded btn-sm" href="#" role="button">View</a>\n                    </li>'};b.buildDbCard=function(a,b){return $ts("<div>",{class:["card","shadow-5"],style:"width: 300px;"}).display(' \n                <div class="bg-image hover-overlay ripple hover-zoom" data-mdb-ripple-color="light">\n                    <img src="/assets/images/background.jpg" class="img-fluid hover-shadow"/>\n                    <a href="javascript:void(0);" id="'+
a+'-meta">\n                        <div class="mask" style="background-color: rgba(251, 251, 251, 0.15);"></div>\n                    </a>\n                </div>\n                <div class="card-body">\n                    <h5 class="card-title">'+b.name+'</h5>\n                    <p class="card-text">'+b.note+'</p>\n                    <a id="'+a+'" href="javascript:void(0);" class="btn btn-primary">Run</a>\n                </div>\n            ')};b.prototype.open_uniprot_onclick=function(){var a=
$ts("#formFile").CType();apps.gcmodeller.getFileOpen(apps.uniprot_assembly).then(function(b){return __awaiter(this,void 0,void 0,function g(){var c;return $jscomp.generator.createGenerator(g,function(d){if(1==d.nextAddress)return c=a,d.yield(b,2);c.value=d.yieldResult;d.jumpToEnd()})})})};b.prototype.imports_onclick=function(){desktop.loading();var a={file:$ts.value("#formFile"),name:$ts.value("#title"),note:$ts.value("#description")};$ts.post("@web_invoke_imports",a,function(a){var b=0==a.code,c=
b?"Imports Task Success":"Imports Task Error";b?desktop.showToastMessage(a.info,c,"success"):desktop.showToastMessage(a.info,c,"danger");desktop.closeSpinner()})};$jscomp.global.Object.defineProperties(b.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return"enrichment_database"}}});c.enrichment_database=b})(c.repository||(c.repository={}))})(pages||(pages={}));
(function(c){(function(c){var b=function(a){return Bootstrap.apply(this,arguments)||this};$jscomp.inherits(b,Bootstrap);b.prototype.init=function(){var a=this;$("#enzyme-tree").jstree({core:{data:function(b,c){return a.buildEnzymeTree(b,c)}}})};b.prototype.loadRootNodes=function(){return __awaiter(this,void 0,void 0,function e(){var b,c;return $jscomp.generator.createGenerator(e,function(d){if(1==d.nextAddress)return d.yield(apps.gcmodeller.getEnzymeClass(),2);b=d.yieldResult;c=JSON.parse(b);return d.return(c)})})};
b.prototype.buildEnzymeTree=function(a,b){"#"===a.id?b([{text:"EC Number",id:"0",children:!0}]):"0"==a.id?this.loadRootNodes().then(function(a){var c=[],d;for(d in a)c.push({text:d,id:a[d].toString(),children:!0});b(c)}):b(["Child"])};b.prototype.run_onclick=function(){desktop.loading("Build blast database...");var a=$ts("#uniprot-file").CType().value,b={uniprot:a};Strings.Empty(a,!0)?desktop.showToastMessage("No uniprot assembly file was provided!","Build enzyme blast+ database","danger"):apps.gcmodeller.createTask("Imports Enzyme Database",
$ts.url("@web_invoke_imports"),JSON.stringify(b)).then(function(a){return __awaiter(this,void 0,void 0,function k(){var b;return $jscomp.generator.createGenerator(k,function(c){if(1==c.nextAddress)return c.yield(a.data,2);b=c.yieldResult;desktop.showTaskAlert();desktop.showToastMessage("Pending a new task: "+b,"Build enzyme blast+ database","info");c.jumpToEnd()})})})};b.prototype.run_rhea_onclick=function(){};b.prototype.button_open_rhea_onclick=function(){desktop.winforms.openfileDialog("#rhea-file",
apps.rhea_reactions)};b.prototype.button_open_uniprot_onclick=function(){desktop.winforms.openfileDialog("#uniprot-file",apps.uniprot_assembly)};$jscomp.global.Object.defineProperties(b.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return"enzyme_database"}}});c.enzyme_database=b})(c.repository||(c.repository={}))})(pages||(pages={}));
(function(c){(function(c){var b=function(a){return Bootstrap.apply(this,arguments)||this};$jscomp.inherits(b,Bootstrap);b.prototype.init=function(){};b.prototype.button_open_uniprot_onclick=function(){desktop.winforms.openfileDialog("#uniprot-file",apps.uniprot_assembly)};b.prototype.run_onclick=function(){desktop.loading("Build blast database...");var a=$ts("#uniprot-file").CType().value,b={uniprot:a};Strings.Empty(a,!0)?desktop.showToastMessage("No uniprot assembly file was provided!","Build enzyme blast+ database",
"danger"):apps.gcmodeller.createTask("Imports Enzyme Database",$ts.url("@web_invoke_imports"),JSON.stringify(b)).then(function(a){return __awaiter(this,void 0,void 0,function k(){var b;return $jscomp.generator.createGenerator(k,function(c){if(1==c.nextAddress)return c.yield(a.data,2);b=c.yieldResult;desktop.showTaskAlert();desktop.showToastMessage("Pending a new task: "+b,"Build enzyme blast+ database","info");c.jumpToEnd()})})})};$jscomp.global.Object.defineProperties(b.prototype,{appName:{configurable:!0,
enumerable:!0,get:function(){return"uniprot_database"}}});c.uniprot_database=b})(c.repository||(c.repository={}))})(pages||(pages={}));
(function(c){(function(c){(function(b){function a(a,b,c,e,h,l,m,p){h=void 0===h?10:h;l=void 0===l?!1:l;m=void 0===m?null:m;p=void 0===p?null:p;var f=$ts(c);f&&(f.clear(),a.populateSuggestion(b,h,l).forEach(function(a){f.appendChild(d(a,p,e))}),isNullOrUndefined(m)||a.hasEquals(b,l)||(a=$ts("<a>",{href:executeJavaScript,text:b,title:b,onclick:function(){m(b)}}).display("add '"+b+"'"),f.append($ts("<div>",{class:p}).display(a))))}function d(a,b,c){var d=$ts("<a>",{href:executeJavaScript,text:a.term,
title:a.term,onclick:function(){c(a)}}).display(a.term);return $ts("<div>",{class:b}).display(d)}b.makeSuggestions=function(b,d,e,n,h,l,m){n=void 0===n?10:n;h=void 0===h?!1:h;l=void 0===l?null:l;m=void 0===m?null:m;var f=new c.suggestion(b);return function(b){a(f,b,d,e,n,h,m,l)}}})(c.render||(c.render={}))})(c.suggestion_list||(c.suggestion_list={}))})(pages||(pages={}));
(function(c){(function(c){var b=function(a){this.terms=a};b.prototype.hasEquals=function(a,b){(b=void 0===b?!1:b)||(a=a.toLowerCase());for(var c=$jscomp.makeIterator(this.terms),d=c.next();!d.done;d=c.next())if(d=d.value,b){if(d.term.toLowerCase()==a)return!0}else if(d.term==a)return!0;return!1};b.prototype.populateSuggestion=function(a,d,f){d=void 0===d?5:d;f=void 0===f?!1:f;var e=a.toLowerCase(),k=$from(this.terms).Select(function(c){var d=b.getScore(c,a,e,f);return{term:c,score:d}}).OrderBy(function(a){return a.score}),
n=k.Where(function(a){return a.score!=c.NA}).Take(d).Select(function(a){return a.term}).ToArray();return n.length==d?n:b.makeAdditionalSuggestion(k,n,f,a,d)};b.makeAdditionalSuggestion=function(a,b,c,d,k){var e=d.toLowerCase();a=a.Skip(b.length).Select(function(a){a=a.term;var b=c?Levenshtein.ComputeDistance(a.term.toLowerCase(),e):Levenshtein.ComputeDistance(a.term,d);return{term:a,score:b}}).OrderBy(function(a){return a.score}).Take(k-b.length).Select(function(a){return a.term}).ToArray();return[].concat($jscomp.arrayFromIterable(b),
$jscomp.arrayFromIterable(a))};b.getScore=function(a,b,d,g){return g?(a=a.term.toLowerCase(),c.term.indexOf(a,d)):a.dist(b)};c.suggestion=b})(c.suggestion_list||(c.suggestion_list={}))})(pages||(pages={}));(function(c){(function(c){c.NA=1E11;var b=function(a,b){this.id=a;this.term=b};b.prototype.dist=function(a){return b.indexOf(this.term,a)};b.indexOf=function(a,b){return-1==a.indexOf(b)?c.NA:Math.abs(b.length-a.length)};c.term=b})(c.suggestion_list||(c.suggestion_list={}))})(pages||(pages={}));
(function(c){(function(c){var b=function(){var a=Bootstrap.apply(this,arguments)||this;a.intptr=0;return a};$jscomp.inherits(b,Bootstrap);b.prototype.init=function(){var a=this;apps.gcmodeller.getProteinIDs().then(function(b){return __awaiter(this,void 0,void 0,function g(){return $jscomp.generator.createGenerator(g,function(c){if(1==c.nextAddress)return c.yield(b,2);b=c.yieldResult;a.protein_ids=b;a.viewBlastp(a.protein_ids[0]);a.intptr=0;$ts("#number_proteins").display(a.protein_ids.length.toString());
c.jumpToEnd()})})})};b.prototype.previous_onclick=function(){0!=this.intptr&&(this.intptr--,this.viewBlastp(this.current_id))};b.prototype.next_onclick=function(){this.intptr!=this.protein_ids.length-1&&(this.intptr++,this.viewBlastp(this.current_id))};b.prototype.viewBlastp=function(a){var b=function(b){var c=[],d=0==b.length||1==b.length&&"HITS_NOT_FOUND"==b[0].HitName,e={};console.table(b[0].HitName);console.log(d);for(var f=0;f<b.length;f++)if(delete b[f].QueryName,delete b[f].HitName,delete b[f].hit_length,
delete b[f].length_hit,delete b[f].length_hsp,delete b[f].length_query,delete b[f].query_length,b[f].evalue=b[f].evalue.toString(),!Strings.Empty(b[f].description,!0)){var l=b[f].description.split("|")[0];c.push(l);l in e||(e[l]=0);e[l]+=b[f].score}f=d?'<div class="alert alert-warning" role="alert" data-mdb-color="warning" style="width: 400px;">\n                    <i class="fas fa-exclamation-triangle me-3"></i>\n                    '+a+" has no hits!\n                </div>":a+" has "+b.length+
" annotation hits supports";$ts("#blast_output").clear();$ts("#protein_id").clear().display(f);d||$ts.appendTable(b,"#blast_output",null,{class:["table","table-sm"]});b=$from(c).GroupBy(function(a){return a}).Select(function(a){return{name:a.Key,value:a.Count}}).ToArray();console.log("get hits summary:");console.table(b);console.log(e);(new js_plot.piePlot("Annotation Hits Supports","Term Hits","preview_1")).plot("protein hits",b);(new js_plot.barplot("preview_2")).plot($from(Object.keys(e)).Select(function(a){return{name:a,
value:Math.log(e[a])}}))};apps.gcmodeller.getBlastp(a).then(function(a){return __awaiter(this,void 0,void 0,function k(){return $jscomp.generator.createGenerator(k,function(c){if(1==c.nextAddress)return c.yield(a,2);a=c.yieldResult;b(JSON.parse(a));c.jumpToEnd()})})})};$jscomp.global.Object.defineProperties(b.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return"blastp_viewer"}},current_id:{configurable:!0,enumerable:!0,get:function(){return isNullOrUndefined(this.protein_ids)||
isNullOrUndefined(this.intptr)||0==this.protein_ids.length?"Missing":this.protein_ids[this.intptr]}}});c.view_protein_blast=b})(c.viewers||(c.viewers={}))})(pages||(pages={}));
(function(c){(function(c){var b=function(){var a=Bootstrap.apply(this,arguments)||this;a.compartments={};a.enzyme_class={};a.category_index={};return a};$jscomp.inherits(b,Bootstrap);b.prototype.init=function(){var a=this,b=$ts("#compartment_list");apps.gcmodeller.getEnzymeClass().then(function(b){return __awaiter(this,void 0,void 0,function k(){var c,d;return $jscomp.generator.createGenerator(k,function(e){if(1==e.nextAddress)return e.yield(b,2);b=e.yieldResult;c=JSON.parse(b);for(d in c)a.enzyme_class[d]=
c[d],a.category_index["EC"+c[d]]=d;console.log(a.enzyme_class);e.jumpToEnd()})})});apps.gcmodeller.getMetabolicCompartments().then(function(c){return __awaiter(this,void 0,void 0,function k(){var d,e,f,m;return $jscomp.generator.createGenerator(k,function(k){if(1==k.nextAddress)return k.yield(c,2);d=k.yieldResult;e=$jscomp.makeIterator(d);for(f=e.next();!f.done;f=e.next())m=f.value,a.compartments[m]=[],b.appendElement($ts("<option>",{value:m}).display(m));k.jumpToEnd()})})})};b.prototype.compartment_list_onchange=
function(a){"string"==typeof a?this.showMetabolicNetwork(a):this.showMetabolicNetwork(a[0])};b.prototype.showMetabolicNetwork=function(a){var b=this;isNullOrEmpty(this.compartments[a])?apps.gcmodeller.getMetabolicEnzymes(a).then(function(c){return __awaiter(this,void 0,void 0,function k(){return $jscomp.generator.createGenerator(k,function(d){if(1==d.nextAddress)return d.yield(c,2);c=d.yieldResult;b.compartments[a]=JSON.parse(c);b.showNetworkImpl(a,b.compartments[a]);b.showGraph(a,b.compartments[a]);
d.jumpToEnd()})})}):(this.showNetworkImpl(a,this.compartments[a]),this.showGraph(a,this.compartments[a]))};b.prototype.showNetworkImpl=function(a,b){var c=[],d=this,e=[],n=$ts("#reaction-graph-data").clear();b=$jscomp.makeIterator(b);for(var h=b.next();!h.done;h=b.next()){h=$jscomp.makeIterator(h.value.reactions);for(var l=h.next();!l.done;l=h.next()){l=l.value;for(var m=$jscomp.makeIterator(l.enzyme),p=m.next();!p.done;p=m.next())c.push(p.value);e.push(l)}}c=$from(c).Where(function(a){return!Strings.Empty(a,
!0)}).GroupBy(function(a){return a.split(".")[0]}).Where(function(a){return"EC"+a.Key in d.category_index}).Select(function(a){return{name:d.category_index["EC"+a.Key],value:a.Count}}).ToArray();console.table(c);console.log(e);(new js_plot.piePlot("Metabolic Composition","Subcellular Location: "+a,"enzyme-class")).plot("Reaction Counts",c);var q=0;$from(e).GroupBy(function(a){return a.entry}).ForEach(function(a){a=a.First;var b=a.entry.replace(":","-");a=$ts("<a>",{id:b,href:"#"}).display(a.definition.replace(/[<]/ig,
"&lt;"));a=$ts("<li>").display(a);q++;n.appendElement(a)});$ts("#number-alert").show();$ts("#number_reactions").display(q.toString())};b.prototype.showGraph=function(a,b){var c={},d=[];b=$jscomp.makeIterator(b);for(var e=b.next();!e.done;e=b.next()){e=e.value;c[e.protein_id]={id:e.protein_id,name:e.protein_id,symbolSize:e.reactions.length+8,category:0};for(var n=$jscomp.makeIterator(e.reactions),h=n.next();!h.done;h=n.next()){h=h.value;h.entry in c||(c[h.entry]={id:h.entry,name:h.definition,symbolSize:8,
category:1});d.push({source:e.protein_id,target:h.entry});var l=h.equation;l=[].concat($jscomp.arrayFromIterable(l.Reactants)).concat(l.Products);l=$jscomp.makeIterator(l);for(var m=l.next();!m.done;m=l.next())m=m.value,m.ID in c||(c[m.ID]={id:m.ID,name:m.ID,symbolSize:8,category:2}),d.push({source:h.entry,target:m.ID})}}(new js_plot.graph_plot("container")).plot("Metabolic_graph@"+a,{nodes:$from(Object.keys(c)).Select(function(a){return c[a]}).ToArray(),links:d,categories:[{name:"Enzyme Protein"},
{name:"Reaction"},{name:"Metabolite"}]})};$jscomp.global.Object.defineProperties(b.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return"metabolic_viewer"}}});c.metabolic_viewer=b})(c.viewers||(c.viewers={}))})(pages||(pages={}));
(function(c){(function(c){var b=function(a){return Bootstrap.apply(this,arguments)||this};$jscomp.inherits(b,Bootstrap);b.prototype.init=function(){var a=LoadText("pwm");a=new viewer.Pspm(a,null);this.motifLogo=new viewer.MotifLogo;this.motifLogo.drawLogo("preview_1",a,2)};$jscomp.global.Object.defineProperties(b.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return"motif_viewer"}}});c.motif_viewer=b})(c.viewers||(c.viewers={}))})(pages||(pages={}));
(function(c){(function(c){var b=function(){var a=Bootstrap.apply(this,arguments)||this;a.port=$ts.location("service");a.pins=[];a.vectors=new Dictionary;return a};$jscomp.inherits(b,Bootstrap);b.prototype.init=function(){$ts.get("http://localhost:"+this.port+"/@counts",function(a){for(var b=$ts("#module_list"),c=$jscomp.makeIterator(Object.keys(a.info)),d=c.next();!d.done;d=c.next())d=d.value,b.appendElement($ts("<option>",{value:d}).display(d+" ["+a.info[d]+" molecules]"))})};b.prototype.module_list_onchange=
function(a){var b=this;b.cur_modu=a[0];a="http://localhost:"+this.port+"/@idset/?set="+encodeURIComponent(b.cur_modu);$ts.get(a,function(a){var c=$ts("#molecules_list").clear();a=a.info;if(0<a.size){a=$jscomp.makeIterator(a.set);for(var d=a.next();!d.done;d=a.next())d=d.value,c.appendElement($ts("<option>",{value:d}).display(d))}b.clear_onclick()})};b.prototype.clear_onclick=function(){this.pins=[];this.vectors=new Dictionary};b.prototype.molecules_list_onchange=function(a){var b=a[0],c=this.cur_modu,
d=this.vectors.Select(function(a){return{name:a.key,data:a.value}}).ToArray();this.get_vector(a[0],function(a,e){(new js_plot.lineplot("Expression of "+b,"From module "+c,"container")).plot(b,e,d)})};b.prototype.get_vector=function(a,b){$ts.get("http://localhost:"+this.port+"/@vector/?m="+this.cur_modu+"&id="+a,function(a){a=a.info;var c=a.vec,d=Array(a.size).fill().map(function(a,b){return[b,c[b]]});b(a.size,d)})};b.prototype.pin_onclick=function(){var a=$ts.select.getOption("#molecules_list"),b=
this;this.pins.push(a);this.get_vector(a,function(c,d){b.vectors.Add(a,d)})};$jscomp.global.Object.defineProperties(b.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return"vcell_viewer"}}});c.vcell_viewer=b})(c.viewers||(c.viewers={}))})(pages||(pages={}));
