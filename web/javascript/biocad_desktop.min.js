var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var b=function(){};b.prototype=a;return new b};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(c){}return!1};$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var c=$jscomp.setPrototypeOf;c(a,b)}else for(c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.superClass_=b.prototype};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.generator={};
$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};
$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};
$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(a){this.abruptCompletion_={return:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(a,b){this.nextAddress=b;return{value:a}};
$jscomp.generator.Context.prototype.yieldAll=function(a,b){a=$jscomp.makeIterator(a);var c=a.next();$jscomp.generator.ensureIteratorResultIsObject_(c);if(c.done)this.yieldResult=c.value,this.nextAddress=b;else return this.yieldAllIterator_=a,this.yield(c.value,b)};$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(a,b){this.catchAddress_=a;void 0!=b&&(this.finallyAddress_=b)};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(a,b){this.nextAddress=a;this.catchAddress_=b||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;a=this.abruptCompletion_.exception;this.abruptCompletion_=null;return a};$jscomp.generator.Context.prototype.enterFinallyBlock=function(a,b,c){c?this.finallyContexts_[c]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=a||0;this.finallyAddress_=b||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(a,b){b=this.finallyContexts_.splice(b||0)[0];if(b=this.abruptCompletion_=this.abruptCompletion_||b){if(b.isException)return this.jumpToErrorHandler_();void 0!=b.jumpTo&&this.finallyAddress_<b.jumpTo?(this.nextAddress=b.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=a};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};
$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var b in a)this.properties_.push(b);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var a=this.properties_.pop();if(a in this.object_)return a}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context;this.program_=a};
$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_);this.context_.next_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(a){this.context_.start_();var b=this.context_.yieldAllIterator_;if(b)return this.yieldAllStep_("return"in b?b["return"]:function(a){return{value:a,done:!0}},a,this.context_.return);this.context_.return(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],a,this.context_.next_);this.context_.throw_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(a,b,c){try{var d=a.call(this.context_.yieldAllIterator_,b);$jscomp.generator.ensureIteratorResultIsObject_(d);if(!d.done)return this.context_.stop_(),d;var e=d.value}catch(f){return this.context_.yieldAllIterator_=null,this.context_.throw_(f),this.nextStep_()}this.context_.yieldAllIterator_=null;c.call(this.context_,e);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var a=this.program_(this.context_);if(a)return this.context_.stop_(),{value:a.value,done:!1}}catch(b){this.context_.yieldResult=void 0,this.context_.throw_(b)}this.context_.stop_();if(this.context_.abruptCompletion_){a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException)throw a.exception;return{value:a.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(a){this.next=function(b){return a.next_(b)};this.throw=function(b){return a.throw_(b)};this.return=function(b){return a.return_(b)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(a,b){b=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(b));$jscomp.setPrototypeOf&&$jscomp.setPrototypeOf(b,a.prototype);return b};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(a){return a instanceof e?a:new e(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};b.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var d=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){d(a,
0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(h){this.asyncThrow_(h)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(l){b.reject(l)}};e.prototype.createResolveAndReject_=
function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(l){this.reject_(l);return}"function"==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
0;a<this.onSettledCallbacks_.length;++a)f.asyncExecute(this.onSettledCallbacks_[a]);this.onSettledCallbacks_=null}};var f=new b;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(h){c.reject(h)}};e.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{d(a(b))}catch(p){f(p)}}:
b}var d,f,g=new e(function(a,b){d=a;f=b});this.callWhenSettled_(c(a,d),c(b,f));return g};e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(c)};e.resolve=c;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(a){return new e(function(b,
d){for(var e=$jscomp.makeIterator(a),f=e.next();!f.done;f=e.next())c(f.value).callWhenSettled_(b,d)})};e.all=function(a){var b=$jscomp.makeIterator(a),d=b.next();return d.done?c([]):new e(function(a,e){function f(b){return function(c){g[b]=c;k--;0==k&&a(g)}}var g=[],k=0;do g.push(void 0),k++,c(d.value).callWhenSettled_(f(g.length-1),e),d=b.next();while(!d.done)})};return e},"es6","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};
$jscomp.polyfill("String.prototype.repeat",function(a){return a?a:function(a){var b=$jscomp.checkStringArgs(this,null,"repeat");if(0>a||1342177279<a)throw new RangeError("Invalid count value");a|=0;for(var d="";a;)if(a&1&&(d+=b),a>>>=1)b+=b;return d}},"es6","es3");
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var e=b.length,f=a.length;c=Math.max(0,Math.min(c|0,b.length));for(var g=0;g<f&&c<e;)if(b[c++]!=a[g++])return!1;return g>=f}},"es6","es3");
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new (c||(c=Promise))(function(e,f){function g(a){try{l(d.next(a))}catch(m){f(m)}}function k(a){try{l(d["throw"](a))}catch(m){f(m)}}function l(a){a.done?e(a.value):(new c(function(b){b(a.value)})).then(g,k)}l((d=d.apply(a,b||[])).next())})},apps;
(function(a){function b(){return __awaiter(this,void 0,void 0,function e(){return $jscomp.generator.createGenerator(e,function(a){desktop.showToastMessage("Please run from webview2 application!","Web app error","warning");a.jumpToEnd()})})}try{var c=window.chrome.webview.hostObjects.gcmodeller}catch(d){c={getUniprotXmlDatabase:b,scanDatabase:b,openEnrichmentPage:b,sendPost:b}}a.gcmodeller=c;a.run=function(){Router.AddAppHandler(new pages.enrichment_database);Router.AddAppHandler(new pages.enrichment_analysis);
Router.AddAppHandler(new pages.dataEmbedding);Router.RunApp()}})(apps||(apps={}));$ts.mode=Modes.debug;$ts(apps.run);var desktop;
(function(a){(function(a){a.RSharpErrorMessage=function(a){var b="R# Error:",c=1;if("string"==typeof a.Message)b=b+"&nbsp;"+a.Message.replace(/[<]/ig,"&lt;");else{b+="<br/><br/>";for(var f=$jscomp.makeIterator(a.Message),g=f.next();!g.done;g=f.next())g=g.value,b+="&nbsp;&nbsp;"+c++ +"."+g.replace(/[<]/ig,"&lt;")+"<br/>"}b=b+"<br/>"+("&nbsp;&nbsp;&nbsp;"+a.Source.replace(/[<]/ig,"&lt;")+"<br/>");b+="&nbsp;&nbsp;&nbsp;"+"~".repeat(a.Source.length)+"<br/>";b+="<br/>";a=$jscomp.makeIterator(a.StackTrace);
for(c=a.next();!c.done;c=a.next())f=c.value,c=f.Method.Namespace+"."+f.Method.Module+"."+f.Method.Method,c=c+" at "+f.File+" line "+f.Line,b+=c.replace(/[<]/ig,"&lt;")+"<br />";return b};a.isRSharpError=function(a){var b=TypeScript.Reflection.$typeof(a);return $ts(["Message","Source","TypeFullName","StackTrace"]).All(function(a){return-1<b.property.indexOf(a)})}})(a.RSharp||(a.RSharp={}))})(desktop||(desktop={}));
(function(a){a.promiseAsyncCallback=function(b,c){return __awaiter(this,void 0,void 0,function e(){return $jscomp.generator.createGenerator(e,function(f){a.parseMessage(b).then(function(f){a.parseResultFlag(b,f).then(function(a){c(a,f)})});f.jumpToEnd()})})}})(desktop||(desktop={}));
(function(a){a.now=function(){return(new Date).toLocaleTimeString()};a.parseResultFlag=function(a,c){return __awaiter(this,void 0,void 0,function e(){var b,g;return $jscomp.generator.createGenerator(e,function(f){if(1==f.nextAddress)return f.yield(a.result,2);g=(b=f.yieldResult)&&0==c.code;return f.return(g)})})};a.parseMessage=function(a){return __awaiter(this,void 0,void 0,function d(){var b,f;return $jscomp.generator.createGenerator(d,function(d){if(1==d.nextAddress)return d.yield(a.data,2);b=
d.yieldResult;if($ts.csv.isTsvFile(b))f={code:0,info:b};else if(b.startsWith("data:"))f={code:0,info:b};else try{f=JSON.parse(b)}catch(k){f={code:500,info:b}}return d.return(f)})})};a.processHtmlMsg=function(b){"string"==typeof b?(b=b.replace(/[<]/ig,"&lt;"),b=Strings.lineTokens(b).join("<br />")):b=a.RSharp.isRSharpError(b)?a.RSharp.RSharpErrorMessage(b):"Unhandle error!";return b}})(desktop||(desktop={}));
(function(a){function b(b,e,f,g,k){e=void 0===e?"Task Error":e;f=void 0===f?"":f;g=void 0===g?"danger":g;return $ts("<div>",{class:["toast","show","fade","toast-"+g],role:"alert","aria-live":"assertive","aria-atomic":"true","data-mdb-color":g,"data-mdb-autohide":(void 0===k?!0:k).toString(),style:"width: 500px;"}).display('        \n            <div class="toast-header toast-'+g+'">\n                <i class="'+c[g]+'"></i>\n                <strong class="me-auto">'+e+"</strong>\n                <small>"+
(f&&"null"!=f.toLowerCase()?f:"")+'</small>\n                <button type="button" class="btn-close" data-mdb-dismiss="toast" aria-label="Close">\n                </button>\n            </div>\n            <div class="toast-body">'+a.processHtmlMsg(b)+"</div>\n        ")}a.showToastMessage=function(c,e,f,g){e=void 0===e?"Task Error":e;f=void 0===f?"info":f;g=void 0===g?!0:g;$ts("#busy-indicator").hide();$ts("#toast-message").appendElement(b(c,e,a.now(),f,g))};var c={success:"fas fa-check fa-lg me-2",
danger:"fas fa-exclamation-circle fa-lg me-2",warning:"fas fa-exclamation-triangle fa-lg me-2",info:"fas fa-info-circle fa-lg me-2"}})(desktop||(desktop={}));var js_plot;
(function(a){var b=function(){};b.prototype.getMaxOnExtent=function(){for(var a=-Infinity,b=-Infinity,e=this.data,f=0;f<e.length;f++){var g=e[f],k=g[this.fieldIndices[this.config.symbolSize]];a=Math.max(g[this.fieldIndices[this.config.color]],a);b=Math.max(k,b)}return{color:a,symbolSize:b}};b.prototype.load=function(a,b){b=void 0===b?[{name:"",index:0},{name:"dim1",index:1},{name:"dim2",index:2},{name:"dim3",index:3}]:b;a=document.getElementById(a);this.myChart=echarts.init(a);this.fieldIndices=b.reduce(function(a,
b){a[b.name]=b.index;return a},{});b=b.map(function(a){return a.name});var c=this;b=$from(b).Skip(1).ToArray();console.log("data field names:");console.log(b);this.config={xAxis3D:"dim1",yAxis3D:"dim2",zAxis3D:"dim3",color:"dim1",symbolSize:"dim2",onChange:function(){c.onchange()}};["xAxis3D","yAxis3D","zAxis3D","color","symbolSize"].forEach(function(a){})};b.prototype.onchange=function(){var a=this,b=a.getMaxOnExtent();a.data&&a.myChart.setOption({visualMap:[{max:b.color/2},{max:b.symbolSize/2}],
xAxis3D:{name:a.config.xAxis3D},yAxis3D:{name:a.config.yAxis3D},zAxis3D:{name:a.config.zAxis3D},series:{dimensions:[a.config.xAxis3D,a.config.yAxis3D,a.config.yAxis3D,a.config.color,a.config.symbolSize],data:a.data.map(function(b,c){return[b[a.fieldIndices[a.config.xAxis3D]],b[a.fieldIndices[a.config.yAxis3D]],b[a.fieldIndices[a.config.zAxis3D]],b[a.fieldIndices[a.config.color]],b[a.fieldIndices[a.config.symbolSize]],c]})}})};b.prototype.plot=function(a,b,e){e=void 0===e?[{name:"",index:0},{name:"dim1",
index:1},{name:"dim2",index:2},{name:"dim3",index:3}]:e;this.data=a;this.load(void 0===b?"Rplot_js":b,e);a=this.getMaxOnExtent();var c=this;c.myChart.setOption({tooltip:{},visualMap:[{top:10,calculable:!0,dimension:3,max:a.color/2,inRange:{color:"#1710c0 #0b9df0 #00fea8 #00ff0d #f5f811 #f09a09 #fe0300".split(" ")},textStyle:{color:"#fff"}},{bottom:10,calculable:!0,dimension:4,max:a.symbolSize/2,inRange:{symbolSize:[10,40]},textStyle:{color:"#fff"}}],xAxis3D:{name:c.config.xAxis3D,type:"value"},yAxis3D:{name:c.config.yAxis3D,
type:"value"},zAxis3D:{name:c.config.zAxis3D,type:"value"},grid3D:{axisLine:{lineStyle:{color:"#fff"}},axisPointer:{lineStyle:{color:"#ffbd67"}},viewControl:{}},series:[{type:"scatter3D",dimensions:[c.config.xAxis3D,c.config.yAxis3D,c.config.yAxis3D,c.config.color,c.config.symbolSize],data:c.data.map(function(a,b){return[a[c.fieldIndices[c.config.xAxis3D]],a[c.fieldIndices[c.config.yAxis3D]],a[c.fieldIndices[c.config.zAxis3D]],a[c.fieldIndices[c.config.color]],a[c.fieldIndices[c.config.symbolSize]],
b]}),symbolSize:12,itemStyle:{borderWidth:1,borderColor:"rgba(255,255,255,0.8)"},emphasis:{itemStyle:{color:"#fff"}}}]})};a.scatter3d=b})(js_plot||(js_plot={}));var pages;(function(a){var b=function(a){return Bootstrap.apply(this,arguments)||this};$jscomp.inherits(b,Bootstrap);b.prototype.generateSsid=function(a){a=JSON.stringify(a);a=desktop.now()+"-"+a+"-"+this.appName;return md5(a)};a.analysis_session=b})(pages||(pages={}));
(function(a){var b=function(a){return Bootstrap.apply(this,arguments)||this};$jscomp.inherits(b,Bootstrap);b.prototype.init=function(){this.scanDatabaseList()};b.prototype.scanDatabaseList=function(){$ts("#busy-indicator").show();apps.gcmodeller.scanDatabase().then(function(a){return __awaiter(this,void 0,void 0,function e(){var c,g,k,l,h,m,n;return $jscomp.generator.createGenerator(e,function(e){if(1==e.nextAddress)return e.yield(a,2);c=e.yieldResult;g=JSON.parse(c||"[]");k=Object.keys(g).length;
l=$ts("#repository");h={};for(m in g)h.$jscomp$loop$prop$key$7=m,h.$jscomp$loop$prop$metadata$8=g[h.$jscomp$loop$prop$key$7],n=b.buildDbCard(h.$jscomp$loop$prop$key$7,h.$jscomp$loop$prop$metadata$8),l.appendElement(n),console.log(h.$jscomp$loop$prop$key$7),$ts("#"+h.$jscomp$loop$prop$key$7).onclick=function(a){return function(){apps.gcmodeller.openEnrichmentPage(a.$jscomp$loop$prop$key$7,a.$jscomp$loop$prop$metadata$8.name,a.$jscomp$loop$prop$metadata$8.note)}}(h),$ts("#"+h.$jscomp$loop$prop$key$7+
"-meta").onclick=function(a){return function(){$ts("#busy-indicator").show();b.showMetadata(a.$jscomp$loop$prop$key$7,a.$jscomp$loop$prop$metadata$8)}}(h),h={$jscomp$loop$prop$key$7:h.$jscomp$loop$prop$key$7,$jscomp$loop$prop$metadata$8:h.$jscomp$loop$prop$metadata$8};$ts("#busy-indicator").hide();desktop.showToastMessage("Found "+k+" database.","Enrichment Database Repository","info");e.jumpToEnd()})})})};b.showMetadata=function(a,d){var c="",f=JSON.stringify({guid:a});c+='<span class="badge badge-primary">Database Name</span>: '+
d.name+"("+a+")<br />";c+='<span class="badge badge-primary">Note</span>: <p class="note note-light">'+d.note+"</p><br />";apps.gcmodeller.sendPost($ts.url("@web_invoke_inspector"),f).then(function(d){return __awaiter(this,void 0,void 0,function l(){return $jscomp.generator.createGenerator(l,function(e){desktop.parseMessage(d).then(function(e){desktop.parseResultFlag(d,e).then(function(d){var f=d?"Load Database Success":"Load Database Error",g=e.info,l=null;console.log(g);if(d){var h=$from(Object.keys(g.summary)).Select(function(a){return{name:a,
info:g.summary[a]}}).Where(function(a){return 0<a.info.unique_size}).Where(function(a){return 1<a.info.unique_size/a.info.clusters});d=h.Select(function(a){return b.summaryLine(a.name,a.info)}).JoinBy("");desktop.showToastMessage("Success!",f,"success");l=function(){for(var c={},d=$jscomp.makeIterator(h.ToArray()),e=d.next();!e.done;c={$jscomp$loop$prop$name$10:c.$jscomp$loop$prop$name$10,$jscomp$loop$prop$model$11:c.$jscomp$loop$prop$model$11},e=d.next())c.$jscomp$loop$prop$model$11=e.value,c.$jscomp$loop$prop$name$10=
c.$jscomp$loop$prop$model$11.name,e="#model-"+c.$jscomp$loop$prop$name$10,console.log(e),$ts(e).onclick=function(c){return function(){$ts("#busy-indicator").show();console.log("view background model: "+c.$jscomp$loop$prop$name$10+"...");b.viewModel(a,c.$jscomp$loop$prop$name$10,c.$jscomp$loop$prop$model$11.info)}}(c)};c+='<span class="badge badge-primary">Protein Counts</span>: '+g.counts+"<br />";c+='<span class="badge badge-primary">Models</span>: '+h.Count+"<br />";c+='<span class="badge badge-primary">Backgrounds</span>: <br /><br />\n                                    <ul class="list-group list-group-light">\n                                        '+
d+"\n                                    </ul>\n                                "}else desktop.showToastMessage(e.info,f,"danger");$ts("#summary-info").display(c);isNullOrUndefined(l)||l()})});e.jumpToEnd()})})})};b.viewModel=function(a,b,e){a=JSON.stringify({guid:a,xref:b});apps.gcmodeller.sendPost($ts.url("@web_invoke_loadModel"),a).then(function(a){return __awaiter(this,void 0,void 0,function k(){return $jscomp.generator.createGenerator(k,function(b){desktop.parseMessage(a).then(function(b){desktop.parseResultFlag(a,
b).then(function(a){if(a){var c=new bootstrap.Modal($ts("#view-background"),{keyboard:!1}),d=b.info.clusters;a=Object.keys(d);a=$from(a).Select(function(a){return'\n                                    <li>                                   \n                                            <a \n                                            href="#" \n                                            onclick="pages.enrichment_database.showProteins(\''+d[a].join(",")+'\')">\n                                            <i class="far fa-file-code"></i>&nbsp;&nbsp;'+
a.replace(/[<]/ig,"&lt;")+"\n                                            ["+d[a].length+" proteins]\n                                        </a>                                     \n                                    </li>                              \n                                    "});$ts("#contentArea").clear();$ts("#contentArea").display(a.JoinBy(""));$ts("#busy-indicator").hide();$ts("#modal-close1").onclick=function(){return c.hide()};$ts("#modal-close2").onclick=function(){return c.hide()};
c.show()}else desktop.showToastMessage(b.info,"Load Model Error","danger")})});b.jumpToEnd()})})})};b.showProteins=function(a){$ts("#protein_ids").CType().value=a.replace(/,/ig,"\n")};b.summaryLine=function(a,b){return'<li class="list-group-item d-flex justify-content-between align-items-center">\n                        <div class="d-flex align-items-center">\n                            <span class="badge rounded-pill badge-success">                \n                                <i class="fab fa-laravel"></i>&nbsp;'+
a+"              \n                            </span>\n                            "+b.clusters+" / "+b.unique_size+'\n                        </div>\n                        <a id="model-'+a+'" class="btn btn-link btn-rounded btn-sm" href="#" role="button">View</a>\n                    </li>'};b.buildDbCard=function(a,b){return $ts("<div>",{class:["card","shadow-5"],style:"width: 300px;"}).display(' \n                <div class="bg-image hover-overlay ripple hover-zoom" data-mdb-ripple-color="light">\n                    <img src="/assets/images/background.jpg" class="img-fluid hover-shadow"/>\n                    <a href="javascript:void(0);" id="'+
a+'-meta">\n                        <div class="mask" style="background-color: rgba(251, 251, 251, 0.15);"></div>\n                    </a>\n                </div>\n                <div class="card-body">\n                    <h5 class="card-title">'+b.name+'</h5>\n                    <p class="card-text">'+b.note+'</p>\n                    <a id="'+a+'" href="javascript:void(0);" class="btn btn-primary">Run</a>\n                </div>\n            ')};b.prototype.open_uniprot_onclick=function(){var a=
$ts("#formFile").CType();apps.gcmodeller.getUniprotXmlDatabase().then(function(b){return __awaiter(this,void 0,void 0,function f(){var c;return $jscomp.generator.createGenerator(f,function(d){if(1==d.nextAddress)return c=a,d.yield(b,2);c.value=d.yieldResult;d.jumpToEnd()})})})};b.prototype.imports_onclick=function(){$ts("#busy-indicator").show();var a={file:$ts.value("#formFile"),name:$ts.value("#title"),note:$ts.value("#description")};a=JSON.stringify(a);apps.gcmodeller.sendPost($ts.url("@web_invoke_imports"),
a).then(function(a){return __awaiter(this,void 0,void 0,function f(){return $jscomp.generator.createGenerator(f,function(b){desktop.parseMessage(a).then(function(b){desktop.parseResultFlag(a,b).then(function(a){var c=a?"Imports Task Success":"Imports Task Error";a?desktop.showToastMessage(b.info,c,"success"):desktop.showToastMessage(b.info,c,"danger");$ts("#busy-indicator").hide()})});b.jumpToEnd()})})})};$jscomp.global.Object.defineProperties(b.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return"enrichment_database"}}});
a.enrichment_database=b})(pages||(pages={}));
(function(a){var b=function(b){return a.analysis_session.apply(this,arguments)||this};$jscomp.inherits(b,a.analysis_session);b.prototype.init=function(){};b.prototype.button_open_click=function(){var a=$ts("#matrix-file").CType(),b=$ts("#busy-indicator");b.show();apps.gcmodeller.getFileOpen("Excel Matrix(*.csv)|*.csv").then(function(c){return __awaiter(this,void 0,void 0,function g(){var d;return $jscomp.generator.createGenerator(g,function(e){if(1==e.nextAddress)return d=a,e.yield(c,2);d.value=e.yieldResult;
b.hide();e.jumpToEnd()})})})};b.prototype.run_click=function(){$ts("#busy-indicator").show();var c=$ts.value("#matrix-file"),d=$ts.value("#dimensions"),e=$ts.select.getOption("#algorithm"),f=a.analysis_session.prototype.generateSsid.call(this,{file:c,dims:d,algo:e});d=JSON.stringify({file:c,ssid:f,dims:d,algorithm:e});var g=this;Strings.Empty(c)?desktop.showToastMessage("The matrix data input file can not be nothing!","Data Embedding Analysis","danger"):apps.gcmodeller.sendPost($ts.url("@web_invoke_embedding"),
d).then(function(a){return __awaiter(this,void 0,void 0,function h(){return $jscomp.generator.createGenerator(h,function(c){desktop.promiseAsyncCallback(a,function(a,c){a?(a=$ts.csv(c.info,!0).Objects(),c=a.Take(10),g.session_id=f,$ts.appendTable(c,"#embedding-table",null,{class:["table","table-sm"]}),b.plot3DScatter(a.ToArray()),desktop.showToastMessage("Run Data Embedding Analysis Success!",e+" Task Success","success")):desktop.showToastMessage(c.info,e+" Task Error","danger")});c.jumpToEnd()})})})};
b.plot3DScatter=function(a){var b=Object.keys(a[0]),c=b[0],f=b[1],g=b[2],k=b[3];a=$from(a).Select(function(a){return[a[c],parseFloat(a[f]),parseFloat(a[g]),parseFloat(a[k])]}).ToArray();console.log("view of the data matrix for plot 3d scatter:");console.log(a);(new js_plot.scatter3d).plot(a,"Rplot_js")};$jscomp.global.Object.defineProperties(b.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return"dataEmbedding"}}});a.dataEmbedding=b})(pages||(pages={}));
(function(a){var b=function(b){return a.analysis_session.apply(this,arguments)||this};$jscomp.inherits(b,a.analysis_session);b.prototype.init=function(){$ts.location.hasQueryArguments&&(this.database=$ts.location("id"));console.log($ts.location);$ts("#busy-indicator").hide()};b.prototype.background_onchange=function(a){a=b.note_mapping[a];for(var c in b.note_mapping)$ts("#"+b.note_mapping[c]).hide();$ts("#"+a).show()};b.prototype.run_onclick=function(){if(Strings.Empty(this.database))desktop.showToastMessage("Please select a database at first!",
"Enrichment Analysis","danger");else{$ts("#busy-indicator").show();var a=$ts.select.getOption("#background"),b=$ts.value("#input_idlist");Strings.Empty(a)?desktop.showToastMessage("Please select a background for enrichment analysis at first!","Enrichment Analysis","danger"):Strings.Empty(b)?desktop.showToastMessage("No gene/protein id list to run enrichment analysis!","Enrichment Analysis","danger"):this.runInternal(a,b)}};b.term_url=function(a){switch(a){case "keyword":return function(a){return'<a target="__blank" href="https://www.uniprot.org/keywords/'+
a[""]+'">'+a.name+"</a>"};case "GO":return function(a){return'<a target="__blank" href="http://amigo.geneontology.org/amigo/term/'+a[""]+'">'+a.name+"</a>"};case "Pfam":return function(a){return'<a target="__blank" href="https://www.ebi.ac.uk/interpro/entry/pfam/'+a[""]+'/">'+a.name+"</a>"};case "InterPro":return function(a){return'<a target="__blank" href="https://www.ebi.ac.uk/interpro/entry/InterPro/'+a[""]+'/">'+a.name+"</a>"};case "EC":return function(a){return'<a target="__blank" href="https://www.genome.jp/dbget-bin/www_bfind_sub?mode=bfind&max_hit=1000&dbkey=enzyme&keywords='+
a[""]+'">'+a.name+"</a>"};default:return function(a){return a.name}}};b.prototype.runInternal=function(c,d){var e=a.analysis_session.prototype.generateSsid.call(this,{type:c,symbols:d}),f=this;d=JSON.stringify({id:this.database,background:c,symbols:Strings.lineTokens(d),ssid:e});var g=b.term_url(c);apps.gcmodeller.sendPost($ts.url("@web_invoke_enrichment"),d).then(function(a){desktop.promiseAsyncCallback(a,function(a,b){var c=a?"Run Enrichment Success":"Analysis Error",d=b.info;console.log(d);a?(a=
$ts.csv(d,!0).Objects().Where(function(a){return.05>a.pvalue}).Select(function(a){a.name=g(a);return a}),$ts("#enrichment-result-table").clear(),$ts.appendTable(a,"#enrichment-result-table",null,{class:["table","table-sm"]}),$ts("#ex-with-icons-tabs-1").removeClass("show").removeClass("active"),$ts("#ex-with-icons-tabs-2").addClass("show").addClass("active"),$ts("#ex-with-icons-tab-1").removeClass("active"),$ts("#ex-with-icons-tab-2").addClass("active"),f.session_id=e,f.plot_onclick(),desktop.showToastMessage("Success!",
c,"success")):desktop.showToastMessage(b.info,c,"danger")})})};b.prototype.plot_onclick=function(){$ts("#busy-indicator").show();var a=JSON.stringify({session_id:this.session_id,type:"bar",background:$ts.select.getOption("#background"),top:5});apps.gcmodeller.sendPost($ts.url("@web_invoke_Rplot?base64=true"),a).then(function(a){return __awaiter(this,void 0,void 0,function f(){return $jscomp.generator.createGenerator(f,function(b){desktop.parseMessage(a).then(function(b){desktop.parseResultFlag(a,
b).then(function(a){var c=a?"Run Enrichment Success":"Analysis Error",d=b.info;console.log(d);a?($ts("#Rplot").CType().src=d,$ts("#Rplot-box").CType().href=d,$ts("#busy-indicator").hide()):desktop.showToastMessage(b.info,c,"danger")})});b.jumpToEnd()})})})};$jscomp.global.Object.defineProperties(b.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return"enrichment_analysis"}}});b.note_mapping={GO:"go_note",keyword:"uniprot_note",Pfam:"pfam_note",InterPro:"interpro_note",EC:"ec_note",
eggNOG:"eggnog_note"};a.enrichment_analysis=b})(pages||(pages={}));
