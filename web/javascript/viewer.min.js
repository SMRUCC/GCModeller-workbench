var viewer;
(function(h){var e=function(){function c(a){this.host=a}c.prototype.doRender=function(a,b,d,f){var p,c="boolean"===typeof d?d:1<a.rows;d=b.getContext("2d");var g=new h.LogoMetrics(d,a.columns,a.rows,c);"number"==typeof f?(b.width=g.summed_width*f,b.height=g.summed_height*f):0===b.width&&0===b.height?(f=1,b.width=g.summed_width,b.height=g.summed_height):0===b.width?(f=b.height/g.summed_height,b.width=g.summed_width*f):0===b.height?(f=b.width/g.summed_width,b.height=g.summed_height*f):f=Math.min(b.width/
g.summed_width,b.height/g.summed_height);if("number"===typeof this.raster_scale&&.1>Math.abs(this.raster_scale-f))var l=this.raster_cache;else this.raster_cache=l=new h.RasterizedAlphabet(a.alphabet,g.stack_font,g.stack_width*f*2),this.raster_scale=f;d=b.getContext("2d");d.save();d.scale(f,f);d.save();d.save();d.translate(g.pad_left,g.pad_top);for(var e=0;e<a.rows;++e){b=a.getPspm(e);f=a.getOffset(e);!c||1!=a.rows&&e==a.rows-1||(d.save(),d.translate(g.summed_width/2,g.name_height),d.font=g.name_font,
d.textAlign="center",d.fillText(b.name,0,0),d.restore(),d.translate(0,g.name_height+Math.min(0,g.name_spacer-g.y_num_height/2)));this.host.draw_scale(d,g,a.alphabet.ic);d.save();d.translate(g.y_label_height+g.y_label_spacer+g.y_num_width+g.y_tic_width,0);(0<b.leftTrim||0<b.rightTrim)&&this.host.draw_trim_background(d,g,b,f);d.translate(0,g.y_num_height/2);for(p=0;p<a.columns;p++){d.translate(g.stack_pad_left,0);if(p>=f&&p<f+b.motif_length){var k=p-f;this.host.draw_stack_num(d,g,k);this.host.draw_stack(d,
g,b.get_stack(k,a.alphabet),l)}d.translate(g.stack_width,0)}d.restore();c&&1!=a.rows&&e==a.rows-1?(d.translate(0,g.y_num_height/2+g.stack_height+Math.max(g.y_num_height/2,g.x_num_above+g.x_num_width+g.name_spacer)),d.save(),d.translate(g.summed_width/2,g.name_height),d.font=g.name_font,d.textAlign="center",d.fillText(b.name,0,0),d.restore(),d.translate(0,g.name_height)):d.translate(0,g.y_num_height/2+g.stack_height+Math.max(g.y_num_height/2,g.x_num_above+g.x_num_width));e!=a.rows-1&&d.translate(0,
g.pad_middle)}d.restore();d.translate(g.summed_width-g.pad_right,g.summed_height-g.pad_bottom);d.font=g.fine_txt_font;d.textAlign="right";d.fillText(a.fine_text,0,0);d.restore();d.restore()};return c}();h.CanvasRender=e})(viewer||(viewer={}));(function(h){h.trim=function(e){var c;e=e.replace(/^\s\s*/,"");var a=/\s/;for(c=e.length;a.test(e.charAt(--c)););return e.slice(0,c+1)}})(viewer||(viewer={}));
(function(h){var e=function(){function c(a,b,d,f){this.target_id=a;this.motifPWM=b;this.scaleLogo=d;this.render=f}c.prototype.run=function(){var a=new h.Alphabet("ACGT"),b=new h.Pspm(this.motifPWM,null);a=this.logo_1(a,"MEME Suite",b);this.replace_logo(a,this.target_id,this.scaleLogo,"Preview Logo","block")};c.prototype.logo_1=function(a,b,d){return(new h.Logo(a,b)).addPspm(d)};c.prototype.replace_logo=function(a,b,d,f,p){var c=$ts("#"+b);b?(b=CanvasHelper.createCanvas([500,1200],b,f,p),null!==b&&
(this.render.draw_logo_on_canvas.doRender(a,b,null,d),c.parentNode.replaceChild(b,c))):alert("Can't find specified id ("+b+")")};return c}();h.LoadQueryTask=e})(viewer||(viewer={}));
(function(h){var e=function(){function c(){this.task_queue=[];this.task_delay=100;this.draw_logo_on_canvas=new h.CanvasRender(this)}c.prototype.drawLogo=function(a,b,d){void 0===d&&(d=2);(new h.LoadQueryTask(a,b,d,this)).run()};c.prototype.draw_scale=function(a,b,d){var f=b.stack_height/d;a.save();a.lineWidth=1.5;a.translate(b.y_label_height,b.y_num_height/2);a.save();a.font=b.y_label_font;a.translate(0,b.stack_height/2);a.save();a.rotate(-(Math.PI/2));a.textAlign="center";a.fillText("bits",0,0);
a.restore();a.restore();a.translate(b.y_label_spacer+b.y_num_width,0);a.save();a.translate(0,b.stack_height);a.font=b.y_num_font;a.textAlign="right";a.textBaseline="middle";for(var c=0;c<=d;c++)a.fillText(""+c,0,0),a.beginPath(),a.moveTo(0,0),a.lineTo(b.y_tic_width,0),a.stroke(),a.translate(0,-f);a.restore();a.translate(b.y_tic_width,0);a.beginPath();a.moveTo(0,0);a.lineTo(0,b.stack_height);a.stroke();a.restore()};c.prototype.draw_stack_num=function(a,b,d){a.save();a.font=b.x_num_font;a.translate(b.stack_width/
2,b.stack_height+b.x_num_above);a.save();a.rotate(-(Math.PI/2));a.textBaseline="middle";a.textAlign="right";a.fillText(""+(d+1),0,0);a.restore();a.restore()};c.prototype.draw_stack=function(a,b,d,f){a.save();a.translate(0,b.stack_height);for(var c=0;c<d.length;c++){var m=d[c];var g=b.stack_height*m.scale;var e=0;5>g-e&&(e=Math.min(e,Math.max(0,g-5)));g-=e;a.translate(0,-(e/2+g));f.draw(a,m.symbol,0,0,b.stack_width,g);a.translate(0,-(e/2))}a.restore()};c.prototype.draw_dashed_line=function(a,b,d,f,
c,m,g){var p=[],e=[];m-=f;var k=g-c;g=Math.pow(m*m+k*k,.5);k=Math.atan2(k,m);m=Math.cos(k);var h=Math.sin(k);for(k=0;k<b.length;++k)p.push(b[k]*m),e.push(b[k]*h);k=d;d=f;f=0;for(a.beginPath();f+b[k]<g;)a.moveTo(d,c),d+=p[k],c+=e[k],a.lineTo(d,c),f+=b[k],k=(k+1)%b.length,d+=p[k],c+=e[k],f+=b[k],k=(k+1)%b.length;f<g&&(a.moveTo(d,c),a.lineTo(d+m*(g-f),c+h*(g-f)));a.stroke()};c.prototype.draw_trim_background=function(a,b,d,f){var c=b.stack_width*d.leftTrim;var e=b.stack_width*d.rightTrim;var g=b.stack_width*
d.motif_length-e;a.save();a.translate(f*b.stack_width,0);a.fillStyle="rgb(240, 240, 240)";0<d.leftTrim&&a.fillRect(0,0,c,b.stack_height);0<d.rightTrim&&a.fillRect(g,0,e,b.stack_height);a.fillStyle="rgb(51, 51, 51)";0<d.leftTrim&&this.draw_dashed_line(a,[3],0,c-.5,0,c-.5,b.stack_height);0<d.rightTrim&&this.draw_dashed_line(a,[3],0,g+.5,0,g+.5,b.stack_height);a.restore()};c.prototype.size_logo_on_canvas=function(a,b,d,f){d="boolean"===typeof d?d:1<a.rows;if(0===b.width||0===b.height)a=new h.LogoMetrics(b.getContext("2d"),
a.columns,a.rows,d),"number"==typeof f?(b.width=a.summed_width*f,b.height=a.summed_height*f):0===b.width&&0===b.height?(b.width=a.summed_width,b.height=a.summed_height):0===b.width?b.width=b.height/a.summed_height*a.summed_width:0===b.height&&(b.height=b.width/a.summed_width*a.summed_height)};return c}();h.MotifLogo=e})(viewer||(viewer={}));
(function(h){var e=function(){function c(a,b){void 0===b&&(b=null);this.freqs=[];this.alphabet=[];this.letter_count=0;for(var d,f=0;f<a.length;f++)d=a.charAt(f),c.is_letter.test(d)&&(this.alphabet[this.letter_count]=d.toUpperCase(),this.freqs[this.letter_count]=-1,this.letter_count++);if("undefined"===typeof b||Strings.Empty(b,!0))for(a=1/this.letter_count,f=0;f<this.letter_count;f++)this.freqs[f]=a;else this.parseBackground(b.split(/\s+/))}Object.defineProperty(c.prototype,"ic",{get:function(){return this.isNucleotide?
2:Math.log(20)/Math.LN2},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"size",{get:function(){return this.letter_count},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isNucleotide",{get:function(){return 20>this.letter_count?!0:!1},enumerable:!0,configurable:!0});c.prototype.parseBackground=function(a){for(var b,d,f=0,p=0;f+1<a.length;f+=2)if(b=a[f],d=a[f+1],c.is_letter.test(b)&&c.is_prob.test(d)){for(b=b.toUpperCase();p<this.letter_count&&this.alphabet[p]!=
b;p++);if(p>=this.letter_count)throw Error("NOT_IN_ALPHABET");this.freqs[p]=parseFloat(d)}};c.prototype.toString=function(){return(this.isNucleotide?"Nucleotide":"Protein")+" Alphabet "+this.alphabet.join("")};c.prototype.getLetter=function(a){if(0>a||a>=this.letter_count)throw Error("BAD_ALPHABET_INDEX");return this.alphabet[a]};c.prototype.getBgfreq=function(a){if(0>a||a>=this.letter_count)throw Error("BAD_ALPHABET_INDEX");if(-1==this.freqs[a])throw Error("BG_FREQ_NOT_SET");return this.freqs[a]};
c.prototype.getColour=function(a){if(0>a||a>=this.letter_count)throw Error("BAD_ALPHABET_INDEX");return this.isNucleotide?h.AlphabetColors.nucleotideColor(this.alphabet[a]):h.AlphabetColors.proteinColor(this.alphabet[a])};c.prototype.isAmbig=function(a){if(0>a||a>=this.letter_count)throw Error("BAD_ALPHABET_INDEX");return this.isNucleotide?-1=="ACGT".indexOf(this.alphabet[a]):-1=="ACDEFGHIKLMNPQRSTVWY".indexOf(this.alphabet[a])};c.prototype.getIndex=function(a){for(var b=0;b<this.letter_count;b++)if(this.alphabet[b]==
a.toUpperCase())return b;throw Error("UNKNOWN_LETTER");};c.is_letter=/^\w$/;c.is_prob=/^((1(\.0+)?)|(0(\.\d+)?))$/;return c}();h.Alphabet=e})(viewer||(viewer={}));
(function(h){(function(e){e.red="rgb(204,0,0)";e.blue="rgb(0,0,204)";e.orange="rgb(255,179,0)";e.green="rgb(0,128,0)";e.yellow="rgb(255,255,0)";e.purple="rgb(204,0,204)";e.magenta="rgb(255,0,255)";e.pink="rgb(255,204,204)";e.turquoise="rgb(51,230,204)";e.nucleotideColor=function(c){switch(c){case "A":return e.red;case "C":return e.blue;case "G":return e.orange;case "T":return e.green;default:throw Error("Invalid nucleotide letter");}};e.proteinColor=function(c){switch(c){case "A":case "C":case "F":case "I":case "L":case "V":case "W":case "M":return e.blue;
case "N":case "Q":case "S":case "T":return e.green;case "D":case "E":return e.magenta;case "K":case "R":return e.red;case "H":return e.pink;case "G":return e.orange;case "P":return e.yellow;case "Y":return e.turquoise;default:throw Error("Invalid protein letter");}}})(h.AlphabetColors||(h.AlphabetColors={}))})(viewer||(viewer={}));
(function(h){var e=function(){function c(a,b){this.columns=this.rows=0;this.alphabet=a;this.fine_text=b;this.pspm_list=[];this.pspm_column=[]}c.prototype.addPspm=function(a,b){void 0===b&&(b=null);if("undefined"===typeof b)b=0;else if(0>b)throw Error("Column index out of bounds.");this.pspm_list[this.rows]=a;this.pspm_column[this.rows]=b;this.rows++;a=b+a.motif_length;a>this.columns&&(this.columns=a);return this};c.prototype.getPspm=function(a){if(0>a||a>=this.rows)throw Error("INDEX_OUT_OF_BOUNDS");
return this.pspm_list[a]};c.prototype.getOffset=function(a){if(0>a||a>=this.rows)throw Error("INDEX_OUT_OF_BOUNDS");return this.pspm_column[a]};return c}();h.Logo=e})(viewer||(viewer={}));
(function(h){var e=function(){return function(c,a,b,d){this.pad_top=5;this.pad_left=10;this.pad_right=5;this.pad_bottom=0;this.pad_middle=20;this.name_height=14;this.name_spacer=0;this.y_label_height=12;this.y_label_spacer=3;this.y_num_height=12;this.y_num_width=0;this.y_tic_width=5;this.stack_pad_left=0;this.stack_font="bold 25px Helvetica, sans-serif";this.stack_height=90;this.stack_width=26;this.stacks_pad_right=5;this.x_num_above=2;this.x_num_height=12;this.x_num_width=0;this.fine_txt_height=
6;this.fine_txt_above=2;this.letter_metrics=[];this.summed_height=this.summed_width=0;var f;"undefined"===typeof d&&(d=!1);this.name_font="bold "+this.name_height+"px Times, sans-serif";this.y_label="bits";this.y_label_font="bold "+this.y_label_height+"px Helvetica, sans-serif";this.y_num_font="bold "+this.y_num_height+"px Helvetica, sans-serif";this.stack_font="bold 25px Helvetica, sans-serif";this.x_num_font="bold "+this.x_num_height+"px Helvetica, sans-serif";this.fine_txt_font="normal "+this.fine_txt_height+
"px Helvetica, sans-serif";c.font=this.y_num_font;for(f=0;2>=f;f++)this.y_num_width=Math.max(this.y_num_width,c.measureText(""+f).width);c.font=this.x_num_font;for(f=1;f<=a;f++)this.x_num_width=Math.max(this.x_num_width,c.measureText(""+f).width);this.summed_height+=this.pad_top+this.pad_bottom;1<b&&(c=this.stack_height+this.pad_middle,d?(c+=this.name_height,c+=Math.max(this.y_num_height/2,this.name_spacer)):c+=this.y_num_height/2,c+=Math.max(this.y_num_height/2,this.x_num_height+this.x_num_above),
this.summed_height+=c*(b-1));this.summed_height+=this.stack_height+this.y_num_height/2;d?(this.summed_height+=this.fine_txt_height+this.fine_txt_above+this.name_height,this.summed_height+=Math.max(this.y_num_height/2,this.x_num_height+this.x_num_above+this.name_spacer)):this.summed_height+=Math.max(this.y_num_height/2,this.x_num_height+this.x_num_above+this.fine_txt_height+this.fine_txt_above);this.summed_width+=this.pad_left+this.pad_right;this.summed_width+=this.y_label_height+this.y_label_spacer;
this.summed_width+=this.y_num_width+this.y_tic_width;this.summed_width+=(this.stack_pad_left+this.stack_width)*a;this.summed_width+=this.stacks_pad_right}}();h.LogoMetrics=e})(viewer||(viewer={}));
(function(h){h.evalueRegexp=/^((?:[+]?[0-9]*\.?[0-9]+(?:[eE][-+]?[0-9]+)?)|inf)$/;var e=function(){function c(a,b,d,f,p,e){void 0===b&&(b=null);void 0===d&&(d=0);void 0===f&&(f=0);void 0===p&&(p=20);void 0===e&&(e=0);this.pspm=[];a instanceof c?this.copyInternal(a):this.parseInternal(a,b,d,f,p,e)}c.prototype.parseInternal=function(a,b,d,f,c,e){if("undefined"===typeof d)d=0;else if("number"!==typeof d||0!==d%1||0>d)throw Error("ltrim must be a non-negative integer, got: "+d);if("undefined"===typeof f)f=
0;else if("number"!==typeof f||0!==f%1||0>f)throw Error("rtrim must be a non-negative integer, got: "+f);if("undefined"!==typeof c&&("number"!==typeof c||0>=c))throw Error("nsites must be a positive number, got: "+c);if("undefined"!==typeof e)if("number"===typeof e){if(0>e)throw Error("evalue must be a non-negative number, got: "+e);this.evalue=e}else if("string"===typeof e)if(h.evalueRegexp.test(e))this.evalue=parseFloat(e);else throw'"evalue must be a non-negative number, got: "'+e+'"';else throw Error("evalue must be a non-negative number, got: "+
e);else this.evalue=void 0;this.name=b;this.nsites=c;this.ltrim=d;this.rtrim=f;"string"===typeof a?this.matrixParseFromString(h.parse_pspm_string(a)):this.createFromValueArray(a)};c.prototype.createFromValueArray=function(a){var b;this.motif_length=a.length;this.alph_length=0<a.length?a[0].length:0;"undefined"===typeof this.nsites&&(this.nsites=20);"undefined"===typeof this.evalue&&(this.evalue=0);this.pspm=[];for(var d=0;d<this.motif_length;d++){if(this.alph_length!=a[d].length)throw Error("COLUMN_MISMATCH");
this.pspm[d]=[];for(var f=b=0;f<this.alph_length;f++)this.pspm[d][f]=a[d][f],b+=this.pspm[d][f];if(isNaN(b)||1<b&&.1<b-1||1>b&&.1<1-b)throw Error("INVALID_SUM");}};c.prototype.matrixParseFromString=function(a){this.alph_length=a.alph_length;this.motif_length=a.motif_length;this.pspm=a.pspm;"undefined"===typeof this.evalue&&(this.evalue="undefined"!==typeof a.evalue?a.evalue:0);"undefined"===typeof this.nsites&&(this.nsites="number"===typeof a.nsites?a.nsites:20)};c.prototype.copyInternal=function(a){this.alph_length=
a.alph_length;this.motif_length=a.motif_length;this.name=a.name;this.nsites=a.nsites;this.evalue=a.evalue;this.ltrim=a.ltrim;this.rtrim=a.rtrim;this.pspm=[];for(var b=0;b<a.motif_length;b++){this.pspm[b]=[];for(var d=0;d<a.alph_length;d++)this.pspm[b][d]=a.pspm[b][d]}};c.prototype.copy=function(){return new c(this)};c.prototype.reverse_complement=function(a){var b,d;if(this.alph_length!=a.size)throw Error("ALPHABET_MISMATCH");if(!a.isNucleotide)throw Error("NO_PROTEIN_RC");var f=0;for(b=this.motif_length-
1;f<b;){var c=this.pspm[f];this.pspm[f]=this.pspm[b];this.pspm[b]=c;f++;b--}f=a.getIndex("A");b=a.getIndex("C");var e=a.getIndex("G");a=a.getIndex("T");for(d=0;d<this.motif_length;d++){var g=this.pspm[d];c=g[f];g[f]=g[a];g[a]=c;c=g[b];g[b]=g[e];g[e]=c}c=this.ltrim;this.ltrim=this.rtrim;this.rtrim=c;return this};c.prototype.get_stack=function(a,b){if(this.alph_length!=b.size)throw Error("ALPHABET_MISMATCH");var d=this.pspm[a];a=this.get_stack_ic(a,b);var c=b.ic;var e=[];for(var m=0;m<this.alph_length;m++)if(!b.isAmbig(m)){var g=
new h.Symbol(m,d[m]*a/c,b);0>=g.scale||e.push(g)}e.sort(h.Symbol.compareSymbol);return e};c.prototype.get_stack_ic=function(a,b){if(this.alph_length!=b.size)throw Error("ALPHABET_MISMATCH");a=this.pspm[a];for(var d=0,c=0;c<this.alph_length;c++)b.isAmbig(c)||0!==a[c]&&(d-=Math.log(a[c])/Math.LN2*a[c]);return b.ic-d};c.prototype.getError=function(a){return 0===this.nsites?0:((a.isNucleotide?4:20)-1)/(2*Math.log(2)*this.nsites)};Object.defineProperty(c.prototype,"leftTrim",{get:function(){return this.ltrim},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"rightTrim",{get:function(){return this.rtrim},enumerable:!0,configurable:!0});c.prototype.as_pspm=function(){for(var a="letter-probability matrix: alength= "+this.alph_length+" w= "+this.motif_length+" nsites= "+this.nsites+" E= "+("number"===typeof this.evalue?this.evalue.toExponential():this.evalue)+"\n",b=0;b<this.motif_length;b++){for(var d=0;d<this.alph_length;d++)0!==d&&(a+=" "),a+=this.pspm[b][d].toFixed(6);a+="\n"}return a};
c.prototype.as_pssm=function(a,b){void 0===b&&(b=null);if("undefined"===typeof b)b=.1;else if("number"!==typeof b)throw Error("Expected number for pseudocount");for(var d="log-odds matrix: alength= "+this.alph_length+" w= "+this.motif_length+" E= "+("number"==typeof this.evalue?this.evalue.toExponential():this.evalue)+"\n",c=Math.log(2),e=this.nsites+b,m=0;m<this.motif_length;m++){for(var g=0;g<this.alph_length;g++){0!==g&&(d+=" ");var h=this.pspm[m][g];var n=a.getBgfreq(g);h=(h*this.nsites+n*b)/
e;var k=-1E4;0<h&&(k=Math.round(Math.log(h/n)/c*100));d+=k}d+="\n"}return d};c.prototype.toString=function(){for(var a="",b,d=0;d<this.pspm.length;d++)b=this.pspm[d],a+=b.join("\t")+"\n";return a};return c}();h.Pspm=e})(viewer||(viewer={}));
(function(h){function e(c){var a;var b=/^((?:[+]?[0-9]*\.?[0-9]+(?:[eE][-+]?[0-9]+)?)|inf)$/;c=h.trim(c).split(/\s+/);for(a=0;a<c.length;){var d=c[a].indexOf("=");if(-1!=d){var f=c[a].substr(0,d);d=c[a].substr(d+1);0<f.length&&0<d.length?(c.splice(a,1,f,"=",d),a+=3):0<f.length?(c.splice(a,1,f,"="),a+=2):0<d.length?(c.splice(a,1,"=",d),a+=2):(c.splice(a,1,"="),a++)}else a++}f={};for(a=0;a<c.length;a+=3){if(3>c.length-a)throw Error("Expected PSPM property was incomplete. Remaing parts are: "+c.slice(a).join(" "));
if("="!==c[a+1])throw Error("Expected '=' in PSPM property between key and value but got "+c[a+1]);d=c[a].toLowerCase();var e=c[a+2];if(!b.test(e))throw Error("Expected numeric value for PSPM property '"+d+"' but got '"+e+"'");f[d]=e}return f}h.parse_pspm_properties=e;h.parse_pspm_string=function(c){var a,b;var d=/^letter-probability\s+matrix:(.*)$/i;c=c.split(/\n/);var f=!0;var p=0;n;k;r;q;var m=[];for(a=0;a<c.length;a++){var g=h.trim(c[a]);if(0!==g.length){if(f){f=!1;var l=d.exec(g);if(null!==l){l=
e(l[1]);if(l.hasOwnProperty("alength")){var n=parseFloat(l.alength);if(4!=n&&20!=n)throw Error("PSPM property alength should be 4 or 20 but got "+n);}if(l.hasOwnProperty("w")){var k=parseFloat(l.w);if(0!==k%1||1>k)throw Error("PSPM property w should be an integer larger than zero but got "+k);}if(l.hasOwnProperty("nsites")){var r=parseFloat(l.nsites);if(0>=r)throw Error("PSPM property nsites should be larger than zero but got "+r);}if(l.hasOwnProperty("e")){var q=l.e;if(0>q)throw Error("PSPM property evalue should be non-negative but got "+
q);}continue}}m[p]=[];l=0;g=g.split(/\s+/);for(b=0;b<g.length;b++){var t=parseFloat(g[b]);if(t!=g[b]||0>t||1<t)throw Error("Expected probability but got '"+g[b]+"'");m[p][l]=t;l++}p++}}if("number"===typeof k){if(m.length!=k)throw Error("Expected PSPM to have a motif length of "+k+" but it was actually "+m.length);}else k=m.length;if("number"!==typeof n&&(n=m[0].length,4!=n&&20!=n))throw Error("Expected length of first row in the PSPM to be either 4 or 20 but got "+n);for(a=0;a<m.length;a++)if(m[a].length!=
n)throw Error("Expected PSPM row "+a+" to have a length of "+n+" but the length was "+m[a].length);return{pspm:m,motif_length:k,alph_length:n,nsites:r,evalue:q}}})(viewer||(viewer={}));
(function(h){var e=function(){function c(a,b,d){this.lookup=[];this.rasters=[];this.dimensions=[];var f=$ts("<canvas>",{width:100,height:100});if(!f.getContext)throw Error("NO_CANVAS_SUPPORT");var e=f.getContext("2d");if(!CanvasHelper.supportsText(e))throw Error("NO_CANVAS_TEXT_SUPPORT");for(var h=Math.round(f.width/2),g=Math.round(f.height-20),l=[],n=0,k=[],r,q=0;q<a.size;++q)if(!a.isAmbig(q)){r=a.getLetter(q);k.push(r);this.lookup[r]=n;f.width=f.width;e=f.getContext("2d");e.font=b;e.fillStyle=a.getColour(q);
e.textAlign="center";e.translate(h,g);e.fillText(r,0,0);e=c.canvas_bounds(e,f.width,f.height);if(0===e.width)throw Error("INVISIBLE_LETTER");l.push(e.width);this.dimensions[n]=e;n++}l.sort(function(a,b){return a-b});h=Math.floor(l.length/10);for(q=0;q<h;++q)l.pop(),l.shift();for(q=f=0;q<l.length;++q)f+=l[q];f/=l.length;for(q=0;q<this.dimensions.length;++q)e=this.dimensions[q],l=d/Math.max(f,e.width),h=e.height*l,n=$ts("<canvas>",{width:d,height:h+40}),h=Math.round(n.width/2),g=Math.round(n.height-
20),e=n.getContext("2d"),e.font=b,e.fillStyle=a.getColour(q),e.textAlign="center",e.translate(h,g),e.save(),e.scale(l,l),e.fillText(k[q],0,0),e.restore(),this.rasters[q]=n,this.dimensions[q]=c.canvas_bounds(e,n.width,n.height)}c.prototype.draw=function(a,b,d,c,e,h){var f=this.lookup[b];b=this.rasters[f];f=this.dimensions[f];a.drawImage(b,0,f.bound_top-1,b.width,f.height+1,d,c,e,h)};c.canvas_bounds=function(a,b,d){var c,e,h,g,l,n,k;a=a.getImageData(0,0,b,d).data;var r=l=g=h=-1;for(c=k=n=0;c<d;c++){for(e=
0;e<b;e++)if(a[c*b*4+4*e+3]){h=c;break}if(-1!=h)break}if(-1!=h){for(c=d-1;c>=h;c--){for(e=0;e<b;e++)if(a[c*b*4+4*e+3]){g=c;break}if(-1!=g)break}k=g-h+1}for(e=0;e<b;e++){for(c=0;c<d;c++)if(a[c*b*4+4*e+3]){l=e;break}if(-1!=l)break}if(-1!=l){for(e=b-1;e>=l;e--){for(c=0;c<d;c++)if(a[c*b*4+4*e+3]){r=e;break}if(-1!=r)break}n=r-l+1}return{bound_top:h,bound_bottom:g,bound_left:l,bound_right:r,width:n,height:k}};return c}();h.RasterizedAlphabet=e;e=function(){return function(){}}();h.RasterBounds=e})(viewer||
(viewer={}));(function(h){var e=function(){function c(a,b,c){this.symbol=c.getLetter(a);this.scale=b;this.colour=c.getColour(a)}c.prototype.toString=function(){return this.symbol+" "+Math.round(1E3*this.scale)/10+"%"};c.compareSymbol=function(a,b){return a.scale<b.scale?-1:a.scale>b.scale?1:0};return c}();h.Symbol=e})(viewer||(viewer={}));
